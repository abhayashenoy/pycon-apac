function eli18n(b){this.textdomain=function(c){return this.messages[c]?this._domain=c:this._domain};b&&b.messages&&this.load(b.messages);b&&b.textdomain&&this.textdomain(b.textdomain)}eli18n.prototype=new function(){this.messages={};this._domain="";this.load=function(g){if(typeof(g)=="object"){for(var h in g){var c=g[h];if(typeof(c)=="object"){if(!this.messages[h]){this.messages[h]={}}for(var b in c){if(typeof(c[b])=="string"){this.messages[h][b]=c[b]}}}}}return this};this.translate=function(c,b){var b=b&&this.messages[b]?b:this._domain;return this.messages[b]&&this.messages[b][c]?this.messages[b][c]:c};this.format=function(h,c,g){h=this.translate(h,g);if(typeof(c)=="object"){for(var b in c){h=h.replace("%"+b,this.translate(c[b],g))}}return h}};function elDialogForm(d){var b=this;var c={"class":"el-dialogform",submit:function(g,h){window.console&&window.console.log&&window.console.log("submit called");h.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:false,modal:true,resizable:false,buttons:{Cancel:function(){b.close()},Ok:function(){b.form.trigger("submit")}}}};this.opts=jQuery.extend(true,c,d,{dialog:{autoOpen:false,close:function(){b.close()}}});if(d&&d.dialog&&d.dialog.buttons&&typeof(d.dialog.buttons)=="object"){this.opts.dialog.buttons=d.dialog.buttons}this.ul=null;this.tabs={};this._table=null;this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog);this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog);this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog);this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog);this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog);this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content);if(this.opts.submit){this.form.bind("submit",function(g){b.opts.submit(g,b)})}if(this.opts.ajaxForm&&jQuery.fn.ajaxForm){this.form.ajaxForm(this.opts.ajaxForm)}if(this.opts.validate){this.form.validate(this.opts.validate)}this.option=function(g,h){return this.dialog.dialog("option",g,h)};this.showError=function(g,h){this.hideMessage();this.hideSpinner();this.error.html(g).show();h&&this.content.hide();return this};this.hideError=function(){this.error.text("").hide();this.content.show();return this};this.showSpinner=function(g){this.error.hide();this.message.hide();this.content.hide();this.spinner.text(g||this.opts.spinner).show();this.option("buttons",{});return this};this.hideSpinner=function(){this.content.show();this.spinner.hide();return this};this.showMessage=function(g,h){this.hideError();this.hideSpinner();this.message.html(g||"").show();h&&this.content.hide();return this};this.hideMessage=function(){this.message.hide();this.content.show();return this};this.tab=function(h,g){h=this.opts.tabPrefix+h;if(!this.ul){this.ul=jQuery("<ul />").prependTo(this.form)}jQuery("<li />").append(jQuery("<a />").attr("href","#"+h).html(g)).appendTo(this.ul);this.tabs[h]={tab:jQuery("<div />").attr("id",h).addClass("tab").appendTo(this.form),table:null};return this};this.table=function(g){g=g&&g.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+g:g;if(g&&this.tabs&&this.tabs[g]){this.tabs[g].table=jQuery("<table />").appendTo(this.tabs[g].tab)}else{this._table=jQuery("<table />").appendTo(this.form)}return this};this.append=function(k,o,h){o=o?"el-df-tab-"+o:"";if(!k){return this}if(o&&this.tabs[o]){if(h){!this.tabs[o].table&&this.table(o);var j=jQuery("<tr />").appendTo(this.tabs[o].table);if(!$.isArray(k)){j.append(jQuery("<td />").append(k))}else{for(var g=0;g<k.length;g++){j.append(jQuery("<td />").append(k[g]))}}}else{if(!jQuery.isArray(k)){this.tabs[o].tab.append(k)}else{for(var g=0;g<k.length;g++){this.tabs[o].tab.append(k[g])}}}}else{if(!h){if(!jQuery.isArray(k)){this.form.append(k)}else{for(var g=0;g<k.length;g++){this.form.append(k[g])}}}else{if(!this._table){this.table()}var j=jQuery("<tr />").appendTo(this._table);if(!jQuery.isArray(k)){j.append(jQuery("<td />").append(k))}else{for(var g=0;g<k.length;g++){j.append(jQuery("<td />").append(k[g]))}}}}return this};this.separator=function(g){g="el-df-tab-"+g;if(this.tabs&&this.tabs[g]){this.tabs[g].tab.append(jQuery("<div />").addClass("separator"));this.tabs[g].table&&this.table(g)}else{this.form.append(jQuery("<div />").addClass("separator"))}return this};this.open=function(){this.ul&&this.form.tabs(this.opts.tabs);this.form.find(":text").keyup(function(g){if(g.keyCode==13){b.form.submit()}});this.dialog.attr("unselectable","on").dialog("open");this.form.find(":text").eq(0).focus();return this};this.close=function(){if(typeof(this.opts.close)=="function"){this.opts.close()}this.dialog.dialog("destroy").remove()}}(function(b){b.fn.elColorPicker=function(j){var c=this;var g=b.extend({},b.fn.elColorPicker.defaults,j);this.hidden=b('<input type="hidden" />').attr("name",g.name).val(g.color||"").appendTo(this);this.palette=null;this.preview=null;this.input=null;function d(k){c.val(k);g.change&&g.change(c.val());c.palette.slideUp()}function h(){c.palette=b("<div />").addClass(g.paletteClass+" rounded-3");for(var k=0;k<g.colors.length;k++){b("<div />").addClass("color").css("background-color",g.colors[k]).attr({title:g.colors[k],unselectable:"on"}).appendTo(c.palette).mouseenter(function(){var o=b(this).attr("title");c.input.val(o);c.preview.css("background-color",o)}).click(function(o){o.stopPropagation();d(b(this).attr("title"))})}c.input=b('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(o){o.stopPropagation()}).keydown(function(p){if(p.ctrlKey||p.metaKey){return true}var o=p.keyCode;if(o==27){return c.mouseleave()}if(o!=8&&o!=13&&o!=46&&o!=37&&o!=39&&(o<48||o>57)&&(o<65||o>70)){return false}var q=b(this).val();if(q.length==7||q.length==0){if(o==13){p.stopPropagation();p.preventDefault();d(q);c.palette.slideUp()}if(p.keyCode!=8&&p.keyCode!=46&&o!=37&&o!=39){return false}}}).keyup(function(o){var p=b(this).val();p.length==7&&/^#[0-9abcdef]{6}$/i.test(p)&&c.val(p)});c.preview=b("<div />").addClass("preview rounded-3").click(function(o){o.stopPropagation();d(c.input.val())});c.palette.append(b("<div />").addClass("clearfix")).append(b("<div />").addClass("panel").append(c.input).append(c.preview));if(g.palettePosition=="outer"){c.palette.hide().appendTo(c.parents("body").eq(0)).mouseleave(function(){b(this).slideUp();c.val(c.val())});c.mouseleave(function(o){if(o.relatedTarget!=c.palette.get(0)){c.palette.slideUp();c.val(c.val())}})}else{c.append(c.palette.hide()).mouseleave(function(o){c.palette.slideUp();c.val(c.val())})}c.val(c.val())}this.empty().addClass(g["class"]+" rounded-3").css({position:"relative","background-color":g.color||""}).click(function(q){if(!c.hasClass("disabled")){!c.palette&&h();if(g.palettePosition=="outer"&&c.palette.css("display")=="none"){var r=b(this).offset();var p=c.palette.width();var k=c.parents("body").width()-r.left>=p?r.left:r.left+b(this).outerWidth()-p;c.palette.css({left:k+"px",top:r.top+b(this).height()+1+"px"})}c.palette.slideToggle()}});this.val=function(k){if(!k&&k!==""){return this.hidden.val()}else{this.hidden.val(k);if(g.update){g.update(this.hidden.val())}else{this.css("background-color",k)}if(c.palette){c.preview.css("background-color",k);c.input.val(k)}}return this};return this};b.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(d){window.console&&window.console.log&&window.console.log(d)},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}})(jQuery);(function(b){b.fn.elBorderSelect=function(j){var p=this;var r=this.eq(0);var c=b.extend({},b.fn.elBorderSelect.defaults,j);var g=b('<input type="text" />').attr({name:c.name+"[width]",size:3}).css("text-align","right").change(function(){p.change()});var k=b("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:c.name+"[color]",palettePosition:"outer",change:function(){p.change()}});var d=b("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:c.styleHeight||null,select:function(){p.change()},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});r.empty().addClass(c["class"]).attr("name",c.name||"").append(b("<table />").attr("cellspacing",0).append(b("<tr />").append(b("<td />").append(g).append(" px")).append(b("<td />").append(d)).append(b("<td />").append(k))));function h(u){function t(v){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !v?"00":hexDigits[(v-v%16)/16]+hexDigits[v%16]}var o=u.match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return o?"#"+t(o[1])+t(o[2])+t(o[3]):""}function q(t){var o=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(o){t=o[1];unit=o[2]}if(t[0]=="."){t="0"+t}t=parseFloat(t);if(isNaN(t)){return""}var u=parseInt(b(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*u);case"pt":return parseInt(t*u/12);case"%":return parseInt(t*u/100)}return t}this.change=function(){c.change&&c.change(this.val())};this.val=function(x){if(!x&&x!==""){var u=parseInt(g.val());return{width:!isNaN(u)?u+"px":"",style:d.val(),color:k.val()}}else{var t,u,z,A,o="";if(x.nodeName||x.css){if(!x.css){x=b(x)}var o=x.css("border");if((o=x.css("border"))){u=z=A=o}else{u=x.css("border-width");z=x.css("border-style");A=x.css("border-color")}}else{u=x.width||"";z=x.style||"";A=x.color||""}g.val(q(u));var t=z.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i);d.val(t?t[1]:"");k.val(h(A));return this}};this.val(c.value);return this};b.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}})(jQuery);(function(b){b.fn.elPaddingInput=function(h){var d=this;var g=b.extend({},b.fn.elPaddingInput.defaults,{name:this.attr("name")},h);this.regexps={main:new RegExp(g.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(g.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(g.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(g.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(g.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")};b.each(["left","top","right","bottom"],function(){d[this]=b('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){b(this).val(c(b(this).val()));j()}).attr("name",g.name+"["+this+"]")});b.each(["uleft","utop","uright","ubottom"],function(){d[this]=b("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){j()}).attr("name",g.name+"["+this+"]");if(g.percents){d[this].append('<option value="%">%</option>')}});this.empty().addClass(g["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom);this.val=function(A){if(!A&&A!==""){var u=c(this.left.val());var B=c(this.top.val());var k=c(this.right.val());var z=c(this.bottom.val());var x={left:u=="auto"||u==0?u:(u!==""?u+this.uleft.val():""),top:B=="auto"||B==0?B:(B!==""?B+this.utop.val():""),right:k=="auto"||k==0?k:(k!==""?k+this.uright.val():""),bottom:z=="auto"||z==0?z:(z!==""?z+this.ubottom.val():""),css:""};if(x.left!==""&&x.right!==""&&x.top!==""&&x.bottom!==""){if(x.left==x.right&&x.top==x.bottom){x.css=x.top+" "+x.left}else{x.css=x.top+" "+x.right+" "+x.bottom+" "+x.left}}return x}else{if(A.nodeName||A.css){if(!A.css){A=b(A)}var p={left:"",top:"",right:"",bottom:""};var o=(A.attr("style")||"").toLowerCase();if(o){o=b.trim(o);var q=o.match(this.regexps.main);if(q){var w=b.trim(q[1]).replace(/\s+/g," ").split(" ",4);p.top=w[0];p.right=w[1]&&w[1]!==""?w[1]:p.top;p.bottom=w[2]&&w[2]!==""?w[2]:p.top;p.left=w[3]&&w[3]!==""?w[3]:p.right}else{b.each(["left","top","right","bottom"],function(){var r=this.toString();q=o.match(d.regexps[r]);if(q){p[r]=q[1]}})}}var A=p}b.each(["left","top","right","bottom"],function(){var t=this.toString();if(typeof(A[t])!="undefined"&&A[t]!==null){A[t]=A[t].toString();var v=c(A[t]);d[t].val(v);var r=A[t].match(/(px|em|pt|%)/i);d["u"+t].val(r?r[1]:"px")}});return this}};function c(k){k=b.trim(k.toString());if(k[0]=="."){k="0"+k}n=parseFloat(k);return !isNaN(n)?n:(k=="auto"?k:"")}function j(){g.change&&g.change(d)}this.val(g.value);return this};b.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:true,change:null}})(jQuery);(function(b){b.fn.elSelect=function(d){var r=this;var w=this.eq(0);var c=b.extend({},b.fn.elSelect.defaults,d);var h=b('<input type="hidden" />').attr("name",c.name);var q=b("<label />").attr({unselectable:"on"}).addClass("rounded-left-3");var j=null;var p=null;if(w.get(0).nodeName=="SELECT"){c.src={};w.children("option").each(function(){c.src[b(this).val()]=b(this).text()});c.value=w.val();c.name=w.attr("name");w.replaceWith((w=b("<div />")))}if(!c.value||!c.src[c.val]){c.value=null;var g=0;for(var t in c.src){if(g++==0){c.value=t}}}this.val=function(o){if(!o&&o!==""){return h.val()}else{if(c.src[o]){h.val(o);k(o);if(j){j.children().each(function(){if(b(this).attr("name")==o){b(this).addClass("active")}else{b(this).removeClass("active")}})}}return this}};function k(o){var x=c.labelTpl||c.tpls[o]||c.tpl;q.html(x.replace(/%val/g,o).replace(/%label/,c.src[o])).children().attr({unselectable:"on"})}w.empty().addClass(c["class"]+" rounded-3").attr({unselectable:"on"}).append(h).append(q).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(o){!j&&u();j.slideToggle();if(b.browser.msie&&!p){j.children().each(function(){p=Math.max(p,b(this).width())});if(p>j.width()){j.width(p+40)}}});this.val(c.value);function u(){j=b("<div />").addClass(c.listClass+" rounded-3").hide().appendTo(w.mouseleave(function(v){j.slideUp()}));for(var x in c.src){var z=c.tpls[x]||c.tpl;b("<div />").attr("name",x).append(b(z.replace(/%val/g,x).replace(/%label/g,c.src[x])).attr({unselectable:"on"})).appendTo(j).hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(C){C.stopPropagation();C.preventDefault();var B=b(this).attr("name");r.val(B);c.select(B);j.slideUp()})}var o=w.outerWidth();if(j.width()<o){j.width(o)}var A=j.height();if(c.maxHeight>0&&A>c.maxHeight){j.height(c.maxHeight)}r.val(h.val())}return this};b.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(c){window.console&&window.console.log&&window.console.log("selected: "+c)},maxHeight:310}})(jQuery);(function(b){elRTE=function(k,h){if(!k||!k.nodeName){return alert('elRTE: argument "target" is not DOM Element')}var c=this,d;this.version="1.0 RC4";this.build="20100330";this.options=b.extend(true,{},this.options,h);this.browser=b.browser;this.target=b(k);this.toolbar=b('<div class="toolbar"/>');this.iframe=document.createElement("iframe");this.workzone=b('<div class="workzone"/>').append(this.iframe).append(this.source);this.statusbar=b('<div class="statusbar"/>');this.tabsbar=b('<div class="tabsbar"/>');this.editor=b('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar);this.doc=null;this.$doc=null;this.window=null;this.utils=new this.utils(this);this.dom=new this.dom(this);this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.options.lang]||{}}});this.filter=new this.filter(this);this.editor.insertAfter(k);var g="";if(k.nodeName=="TEXTAREA"){this.source=this.target.remove();this.source.insertAfter(this.iframe).hide();g=this.target.val()}else{this.source=b("<textarea />").insertAfter(this.iframe).hide();this.source.attr("name",this.target.attr("id")||this.target.attr("name"));g=this.target.hide().html()}g=b.trim(g);if(!g){g="&nbsp;"}if(this.options.allowSource){this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+c.i18n("Editor")+'</div><div class="tab source rounded-bottom-7">'+c.i18n("Source")+'</div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(o){if(!b(this).hasClass("active")){c.tabsbar.children(".tab").toggleClass("active");c.workzone.children().toggle();if(b(this).hasClass("editor")){c.val(c.source.val()||"&nbsp;");c.window.focus();c.ui.update(true)}else{c.updateSource();c.source.focus();if(b.browser.msie){}else{c.source[0].setSelectionRange(0,0)}c.ui.disable();c.statusbar.empty()}}})}this.window=this.iframe.contentWindow;this.doc=this.iframe.contentWindow.document;this.$doc=b(this.doc);d='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';b.each(c.options.cssfiles,function(){d+='<link rel="stylesheet" type="text/css" href="'+this+'" />'});this.doc.open();this.doc.write(c.options.doctype+d+"</head><body>"+(this.filter.fromSource(g))+"</body></html>");this.doc.close();this.source.val(this.filter.toSource(g));if(b.browser.msie){this.doc.body.contentEditable=true}else{try{this.doc.designMode="on"}catch(j){}this.doc.execCommand("styleWithCSS",false,this.options.styleWithCSS)}if(this.options.height>0){this.workzone.height(this.options.height);b(this.iframe).height(this.options.height);this.source.height(this.options.height)}this.window.focus();this.history=new this.history(this);this.selection=new this.selection(this);this.ui=new this.ui(this);this.target.parents("form").bind("submit",function(){c.beforeSave()});this.$doc.bind("mouseup",function(){c.ui.update()}).bind("keyup",function(o){if((o.keyCode>=8&&o.keyCode<=13)||(o.keyCode>=32&&o.keyCode<=40)||o.keyCode==46||(o.keyCode>=96&&o.keyCode<=111)){c.ui.update()}}).bind("keydown",function(o){if((o.metaKey||o.ctrlKey)&&o.keyCode==65){c.ui.update()}else{if(o.keyCode==13){var p=c.selection.getNode();if(c.dom.selfOrParent(p,/^PRE$/)){c.selection.insertNode(c.doc.createTextNode("\r\n"));return false}else{if(b.browser.safari&&o.shiftKey){c.selection.insertNode(c.doc.createElement("br"));return false}}}}});this.typing=false;this.lastKey=null;this.$doc.bind("keydown",function(o){if((o.keyCode>=48&&o.keyCode<=57)||o.keyCode==61||o.keyCode==109||(o.keyCode>=65&&o.keyCode<=90)||o.keyCode==188||o.keyCode==190||o.keyCode==191||(o.keyCode>=219&&o.keyCode<=222)){if(!c.typing){c.history.add(true)}c.typing=true;c.lastKey=null}else{if(o.keyCode==8||o.keyCode==46||o.keyCode==32||o.keyCode==13){if(o.keyCode!=c.lastKey){c.history.add(true)}c.lastKey=o.keyCode;c.typing=false}}}).bind("mouseup",function(){c.typing=false;c.lastKey=null}).bind("paste",function(o){setTimeout(function(){c.updateSource();b(c.doc.body).html(c.filter.fromSource(c.source.val()))},30)});if(b.browser.msie){this.$doc.bind("keyup",function(o){if(o.keyCode==86&&(o.metaKey||o.ctrlKey)){c.updateSource();b(c.doc.body).html(c.filter.fromSource(c.source.val()))}})}this.window.focus()};elRTE.prototype.i18n=function(c){return this._i18n.translate(c)};elRTE.prototype.open=function(){this.editor.show()};elRTE.prototype.close=function(){this.editor.hide()};elRTE.prototype.updateSource=function(){this.source.val(this.filter.toSource(b(this.doc.body).html()))};elRTE.prototype.val=function(c){if(typeof(c)=="string"){b(this.doc.body).html(this.filter.fromSource(c))}else{this.updateSource();return this.source.val()}};elRTE.prototype.beforeSave=function(){if(this.source.is(":hidden")){this.updateSource()}else{this.source.val(this.filter.toSource(this.filter.fromSource(this.source.val())))}};elRTE.prototype.save=function(){this.beforeSave();this.editor.parents("form").submit()};elRTE.prototype.log=function(c){if(window.console&&window.console.log){window.console.log(c)}};elRTE.prototype.i18Messages={};b.fn.elrte=function(h,c){var g=typeof(h)=="string"?h:"",d;this.each(function(){if(!this.elrte){this.elrte=new elRTE(this,typeof(h)=="object"?h:{})}switch(g){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break}});if(g=="val"){if(!this.length){return""}else{if(this.length==1){return c?this[0].elrte.val(c):this[0].elrte.val()}else{d={};this.each(function(){d[this.elrte.source.attr("name")]=this.elrte.val()});return d}}}return this}})(jQuery);(function(b){elRTE.prototype.dom=function(d){this.rte=d;var c=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/};this.root=function(){return this.rte.body};this.create=function(g){return this.rte.doc.createElement(g)};this.createBookmark=function(){var g=this.rte.doc.createElement("span");g.id="elrte-bm-"+Math.random().toString().substr(2);b(g).addClass("elrtebm");return g};this.indexOf=function(h){var g=0;h=b(h);while((h=h.prev())&&h.length){g++}return g};this.attr=function(j,g){var h="";if(j.nodeType==1){h=b(j).attr(g);if(h&&g!="src"&&g!="href"){h=h.toString().toLowerCase()}}return h||""};this.findCommonAncestor=function(k,j){if(!k||!j){return this.rte.log("dom.findCommonAncestor invalid arguments")}if(k==j){return k}else{if(k.nodeName=="BODY"||j.nodeName=="BODY"){return this.rte.doc.body}}var p=b(k).parents(),o=b(j).parents(),g=o.length-1,q=o[g];for(var h=p.length-1;h>=0;h--,g--){if(p[h]==o[g]){q=p[h]}else{break}}return q};this.isEmpty=function(g){if(g.nodeType==1){return this.regExp.textNodes.test(g.nodeName)?b.trim(b(g).text()).length==0:false}else{if(g.nodeType==3){return/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(g.parentNode.nodeName)||g.nodeValue==""||(b.trim(g.nodeValue).length==0&&!(g.nextSibling&&g.previousSibling&&g.nextSibling.nodeType==1&&g.previousSibling.nodeType==1&&!this.regExp.block.test(g.nextSibling.nodeName)&&!this.regExp.block.test(g.previousSibling.nodeName)))}}return true};this.next=function(g){while(g.nextSibling&&(g=g.nextSibling)){if(g.nodeType==1||(g.nodeType==3&&!this.isEmpty(g))){return g}}return null};this.prev=function(g){while(g.previousSibling&&(g=g.previousSibling)){if(g.nodeType==1||(g.nodeType==3&&!this.isEmpty(g))){return g}}return null};this.isPrev=function(h,g){while((h=this.prev(h))){if(h==g){return true}}return false};this.nextAll=function(h){var g=[];while((h=this.next(h))){g.push(h)}return g};this.prevAll=function(h){var g=[];while((h=this.prev(h))){g.push(h)}return g};this.toLineEnd=function(h){var g=[];while((h=this.next(h))&&h.nodeName!="BR"&&h.nodeName!="HR"&&this.isInline(h)){g.push(h)}return g};this.toLineStart=function(h){var g=[];while((h=this.prev(h))&&h.nodeName!="BR"&&h.nodeName!="HR"&&this.isInline(h)){g.unshift(h)}return g};this.isFirstNotEmpty=function(g){while((g=this.prev(g))){if(g.nodeType==1||(g.nodeType==3&&b.trim(g.nodeValue)!="")){return false}}return true};this.isLastNotEmpty=function(g){while((g=this.next(g))){if(!this.isEmpty(g)){return false}}return true};this.isOnlyNotEmpty=function(g){return this.isFirstNotEmpty(g)&&this.isLastNotEmpty(g)};this.findLastNotEmpty=function(g){this.rte.log("findLastNotEmpty Who is here 0_o");if(g.nodeType==1&&(l=g.lastChild)){if(!this.isEmpty(l)){return l}while(l.previousSibling&&(l=l.previousSibling)){if(!this.isEmpty(l)){return l}}}return false};this.isInline=function(j){if(j.nodeType==3){return true}else{if(j.nodeType==1){j=b(j);var h=j.css("display");var g=j.css("float");return h=="inline"||h=="inline-block"||g=="left"||g=="right"}}return true};this.is=function(h,g){if(h&&h.nodeName){if(typeof(g)=="string"){g=this.regExp[g]||/.?/}if(g instanceof RegExp&&h.nodeName){return g.test(h.nodeName)}else{if(typeof(g)=="function"){return g(h)}}}return false};this.filter=function(k,j){var g=[],h;if(!k.push){return this.is(k,j)?k:null}for(h=0;h<k.length;h++){if(this.is(k[h],j)){g.push(k[h])}}return g};this.parents=function(j,h){var g=[];while(j&&(j=j.parentNode)&&j.nodeName!="BODY"&&j.nodeName!="HTML"){if(this.is(j,h)){g.push(j)}}return g};this.parent=function(h,g){return this.parents(h,g)[0]||null};this.selfOrParent=function(j,h,g){return this.is(j,h)?j:this.parent(j,g||h)};this.selfOrParentLink=function(g){g=this.selfOrParent(g,/^A$/);return g&&g.href?g:null};this.selfOrParentAnchor=function(g){g=this.selfOrParent(g,/^A$/);return g&&!g.href&&g.name?g:null};this.childLinks=function(h){var g=[];b("a[href]",h).each(function(){g.push(this)});return g};this.selectionHas=function(h){var j=this.rte.selection.cloneContents(),g;if(j&&j.childNodes&&j.childNodes.length){for(g=0;g<j.childNodes.length;g++){if(typeof(h)=="function"){if(h(j.childNodes[g])){return true}}else{if(j instanceof RegExp){if(h.test(j.childNodes[g].nodeName)){return true}}}}}return false};this.wrap=function(h,g){h=h.length?h:[h];g=g.nodeName?g:this.create(g);g=h[0].parentNode.insertBefore(g,h[0]);b(h).each(function(){if(this!=g){g.appendChild(this)}});return g};this.wrapContents=function(j,g){g=g.nodeName?g:this.create(g);for(var h=0;h<j.childNodes.length;h++){g.appendChild(j.childNodes[h])}j.appendChild(g);return g};this.cleanNode=function(g){if(g.nodeType!=1){return}if(/^(P|LI)$/.test(g.nodeName)&&(l=this.findLastNotEmpty(g))&&l.nodeName=="BR"){b(l).remove()}$n=b(g);$n.children().each(function(){this.cleanNode(this)});if(g.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(g)&&this.isEmpty(g)){return $n.remove()}if($n.attr("style")===""){$n.removeAttr("style")}if(this.rte.browser.safari&&$n.hasClass("Apple-span")){$n.removeClass("Apple-span")}if(g.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")){$n.replaceWith($n.html())}};this.cleanChildNodes=function(h){var g=this.cleanNode;b(h).children().each(function(){g(this)})};this.tableMatrix=function(k){var j=[];if(k&&k.nodeName=="TABLE"){var h=0;function g(p){for(var o=0;o<=h;o++){if(!j[p][o]){return o}}}b(k).find("tr").each(function(o){if(!b.isArray(j[o])){j[o]=[]}b(this).children("td,th").each(function(){var q=parseInt(b(this).attr("colspan")||1);var u=parseInt(b(this).attr("rowspan")||1);var t=g(o);for(var z=0;z<u;z++){for(var p=0;p<q;p++){var r=o+z;if(!b.isArray(j[r])){j[r]=[]}var v=p==0&&z==0?this:(z==0?p:"-");j[r][t+p]=v}}h=Math.max(h,j[o].length)})})}return j};this.indexesOfCell=function(k,j){for(var g=0;g<j.length;g++){for(var h=0;h<j[g].length;h++){if(j[g][h]==k){return[g,h]}}}};this.fixTable=function(t){if(t&&t.nodeName=="TABLE"){var j=b(t);var q=this.tableMatrix(t);var g=0;b.each(q,function(){g=Math.max(g,this.length)});if(g==0){return j.remove()}for(var o=0;o<q.length;o++){var h=q[o].length;if(h==0){j.find("tr").eq(o).remove()}else{if(h<g){var k=g-h;var p=j.find("tr").eq(o);for(i=0;i<k;i++){p.append("<td>&nbsp;</td>")}}}}}};this.tableColumn=function(j,h,p){j=this.selfOrParent(j,/^TD|TH$/);var k=this.selfOrParent(j,/^TABLE$/);ret=[];info={offset:[],delta:[]};if(j&&k){p&&this.fixTable(k);var v=this.tableMatrix(k);var w=false;var u;for(var g=0;g<v.length;g++){for(var t=0;t<v[g].length;t++){if(v[g][t]==j){u=t;w=true;break}}if(w){break}}if(u>=0){for(var g=0;g<v.length;g++){var o=v[g][u]||null;if(o){if(o.nodeName){ret.push(o);if(h){info.delta.push(0);info.offset.push(u)}}else{var q=parseInt(o);if(!isNaN(q)&&v[g][u-q]&&v[g][u-q].nodeName){ret.push(v[g][u-q]);if(h){info.delta.push(q);info.offset.push(u)}}}}}}}return !h?ret:{column:ret,info:info}}}})(jQuery);(function(b){elRTE.prototype.filter=function(g){var c=this,d,h;this.rte=g;this._xhtml=g.options.doctype.match(/xhtml/i)?true:false;this._chains={};this._allow=g.options.allowTags||[];this._deny=g.options.denyTags||[];this.swfClass="elrte-swf-placeholder";h=b("<span />").addClass(this.swfClass).appendTo(g.editor).text("swf")[0];if(typeof h.currentStyle!="undefined"){url=h.currentStyle.backgroundImage}else{url=document.defaultView.getComputedStyle(h,null).getPropertyValue("background-image")}b(h).remove();this.swfSrc=url?url.replace(/^url\("?([^"]+)"?\)$/,"$1"):"";for(d in this.chains){if(this.chains.hasOwnProperty(d)){this._chains[d]=[];b.each(this.chains[d],function(){if(typeof(c.rules[this])=="function"){c._chains[d].push(c.rules[this])}})}}if(!this._chains.toSource||!this._chains.toSource.length){this._chains.toSource=[this.rules.toSource]}if(!this._chains.fromSource||!this._chains.fromSource.length){this._chains.fromSource=[this.rules.fromSource]}this.proccess=function(k,j){if(this._chains[j]){b.each(this._chains[j],function(){k=this(c,k)})}return k};this.toSource=function(j){return this.proccess(j,"toSource")};this.fromSource=function(j){return this.proccess(j,"fromSource")};this.addReplacement=function(k,j){if(typeof(k)=="function"){this._chains.fromSource.unshift(k)}if(typeof(j)=="function"){this._chains.toSource.unshift(k)}}};elRTE.prototype.filter.prototype.rules={cleanup:function(j,g){var d=j._allow.length,h=j._deny.length,c=["","xx-small","x-small","small","medium","large","x-large","xx-large"],k={b:["strong"],big:["span","font-size:large"],center:["div","text-align:center"],font:["span"],i:["em"],nobr:["span","white-space:nowrap"],small:["span","font-size:small"],u:["span","text-decoration:underline"]};if(b.browser.opera||b.browser.msie){g=j.rules.tagsToLower(j,g)}g=g.replace(/\<(\/?)(b|i|u|font|center|nobr|big|small)(\s+[^>]*)?\>/gi,function(p,q,r,o){r=r.toLowerCase(r);o=(o||"").toLowerCase(o);if(k[r]){if(!q&&k[r][1]){o=o.indexOf('style="')==-1?o+' style="'+k[r][1]+'"':o.replace('style="','style="'+k[r][1]+";")}return"<"+q+k[r][0]+o+">"}return p});g=g.replace(/\<([a-z1-6]+)\s+([^>]*(border|bordercolor|color|background|bgcolor|align|valign|hspace|vspace|clear|size|face)=[^>]*)\>/gi,function(u,x,p){var q={},o=p.match(/([a-z]+)="([^"]*)"/gi),w,r;function v(t){if(!q.style){q.style=""}q.style=t+";"+q.style}if(o){for(r=0;r<o.length;r++){w=o[r].split("=");q[w[0]]=w[1].replace(/"/g,"")}}if(q.border){v("border:"+q.border+"px solid "+(q.bordercolor||"#000"));delete q.border;delete q.bordercolor}if(q.color){v("color:"+q.color);delete q.color}if(q.background){v("background-image:url("+q.background+")");delete q.background}if(q.bgcolor){v("background-color:"+q.bgcolor);delete q.bgcolor}if(q.align){if(x=="img"){if(q.align.match(/(left|right)/)){v("float:"+q.align)}else{v("vertical-align:"+q.align)}}else{if(x=="table"){if(q.align=="center"){v("margin-left:auto;margin-right:auto")}else{v("float:"+q.align)}}else{v("text-align:"+q.align)}}delete q.align}if(q.valign){v("vertical-align:"+q.valign);delete q.valign}if(q.hspace){v("margin-left:"+q.hspace+"px;margin-right:"+q.hspace+"px");delete q.hspace}if(q.vspace){v("margin-top:"+q.vspace+"px;margin-bottom:"+q.vspace+"px");delete q.vspace}if(q.size&&x!="input"){if(x=="hr"){v("height:"+q.size+"px")}else{v("font-size:"+(c[q.size]||"medium"))}delete q.size}if(q.clear){v("clear:"+(q.clear=="all"?"both":q.clear));delete q.clear}if(q.face){delete q.face}p="";for(r in q){if(q.hasOwnProperty(r)&&q[r]){p+=" "+r+'="'+q[r]+'"'}}return"<"+x+p+">"});if(d||h){g=g.replace(/\<(\/?)([a-z1-6]+)([^>]*)\>/gi,function(p,q,r,o){r=r.toLowerCase(r);return(d&&b.inArray(r,j._allow)==-1)||(h&&b.inArray(r,j._deny)!=-1)?"":"<"+q+r+o+">"})}return g},tagsToLower:function(d,c){return c.replace(/\<(\/?)([a-z1-6]+)([^\>]*)\>/ig,function(k,j,h,g){g=g.replace(/([a-z\-]+)\:/ig,function(p,o){return o.toLowerCase()+":"});g=g.replace(/([a-z\-]+)=/ig,function(p,o){return o.toLowerCase()+"="});g=g.replace(/([a-z\-]+)=([a-z1-9\-]+)/ig,function(q,o,p){return o+'="'+p+'"'});return"<"+j+h.toLowerCase()+g+">"})},xhtmlTags:function(d,c){return c.replace(/\<(img|hr|br)([^>\/]*)\>/gi,"<$1$2 />")},toSource:function(d,c){c=d.rules.restore(d,c);c=d.rules.cleanup(d,c);if(d._xhtml){c=d.rules.xhtmlTags(d,c)}return c},fromSource:function(d,c){c=d.rules.replace(d,c);c=d.rules.cleanup(d,c);return c},replace:function(d,c){var g=b("<div/>").html(c);g.find('object[classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"]').each(function(){var r=b(this),q=r.children('param[name="'+(b.browser.msie?"Movie":"movie")+'"]').attr("value"),p=r.attr("style")||"",k=parseInt(r.css("width")||0)||parseInt(r.attr("width")||0)||"",u=parseInt(r.css("height")||0)||parseInt(r.attr("height")||0)||"",v=r.css("float")||r.attr("align"),j=r.css("vertical-align"),o=b('<img src="'+d.swfSrc+'" class="'+d.swfClass+'" rel="'+q+'" />');o.attr("style",p).css({width:k?(k+"px"):"auto",height:u?u+"px":"auto","float":v,"vertical-align":j});b(this).replaceWith(o)}).end().find('embed[type="application/x-shockwave-flash"]').each(function(){var r=b(this),q=r.attr("src"),p=r.attr("style")||"",k=parseInt(r.css("width")||0)||parseInt(r.attr("width")||0)||"",u=parseInt(r.css("height")||0)||parseInt(r.attr("height")||0)||"",v=r.css("float")||r.attr("align"),j=r.css("vertical-align"),o=b('<img src="'+d.swfSrc+'" class="'+d.swfClass+'" rel="'+q+'" />');o.attr("style",p).css({width:k?(k+"px"):"auto",height:u?u+"px":"auto","float":v,"vertical-align":j});b(this).replaceWith(o)});return g.html()},restore:function(d,c){var g=b("<div/>").html(c);g.find("."+d.swfClass).each(function(){var k=b(this),j=parseInt(k.css("width"))||"",p=parseInt(k.css("height"))||"",o=k.attr("style");obj='<embed type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+k.attr("rel")+'" width="'+j+'" height="'+p+'" style="'+o+'" play="true" loop="true" menu="true"> </embed>';k.replaceWith(b(obj))}).end().find(".Apple-style-span").removeClass("Apple-style-span").end().find("*").each(function(){var h=b(this);if(h.attr("class")==""){h.removeAttr("class")}if(h.attr("style")==""){h.removeAttr("style")}});return g.html()}};elRTE.prototype.filter.prototype.chains={toSource:["toSource"],fromSource:["fromSource"]}})(jQuery);(function(b){elRTE.prototype.history=function(c){this.rte=c;this._prev=[];this._next=[];this.add=function(){if(this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength){this._prev.slice(this.rte.options.historyLength)}var d=this.rte.selection.getBookmark();this._prev.push([b(this.rte.doc.body).html(),d]);this.rte.selection.moveToBookmark(d);this._next=[]};this.back=function(){if(this._prev.length){var d=this.rte.selection.getBookmark(),g=this._prev.pop();this._next.push([b(this.rte.doc.body).html(),d]);b(this.rte.doc.body).html(g[0]);this.rte.selection.moveToBookmark(g[1])}};this.fwd=function(){if(this._next.length){var d=this.rte.selection.getBookmark(),g=this._next.pop();this._prev.push([b(this.rte.doc.body).html(),d]);b(this.rte.doc.body).html(g[0]);this.rte.selection.moveToBookmark(g[1])}};this.canBack=function(){return this._prev.length};this.canFwd=function(){return this._next.length}}})(jQuery);(function(b){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,lang:"en",toolbar:"normal",absoluteURLs:true,allowSource:true,fmAllow:true,fmOpen:null,allowTags:[],denyTags:["iframe"],buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating"},panels:{save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}})(jQuery);(function(b){elRTE.prototype.selection=function(h){this.rte=h;var d=this;this.w3cRange=null;var p,c,k,o;b(this.rte.doc).keyup(function(q){if(q.ctrlKey||q.metaKey||(q.keyCode>=8&&q.keyCode<=13)||(q.keyCode>=32&&q.keyCode<=40)||q.keyCode==46||(q.keyCode>=96&&q.keyCode<=111)){d.cleanCache()}}).mousedown(function(q){if(q.target.nodeName=="HTML"){p=d.rte.doc.body}else{p=q.target}c=k=null}).mouseup(function(q){if(q.target.nodeName=="HTML"){c=d.rte.doc.body}else{c=q.target}c=q.target;k=null}).click();function j(){return d.rte.window.getSelection?d.rte.window.getSelection():d.rte.window.document.selection}function g(t,r,q){while(t.nodeName!="BODY"&&t.parentNode&&t.parentNode.nodeName!="BODY"&&(r?t!==r&&t.parentNode!=r:1)&&((q=="left"&&d.rte.dom.isFirstNotEmpty(t))||(q=="right"&&d.rte.dom.isLastNotEmpty(t))||(d.rte.dom.isFirstNotEmpty(t)&&d.rte.dom.isLastNotEmpty(t)))){t=t.parentNode}return t}this.collapsed=function(){return this.getRangeAt().isCollapsed()};this.collapse=function(q){this.getRangeAt().collapse(q?true:false)};this.getRangeAt=function(u){if(this.rte.browser.msie){if(!this.w3cRange){this.w3cRange=new this.rte.w3cRange(this.rte)}u&&this.w3cRange.update();return this.w3cRange}var q=j();var t=q.rangeCount>0?q.getRangeAt(0):this.rte.doc.createRange();t.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer};t.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer};t.isCollapsed=function(){return this.collapsed};return t};this.saveIERange=function(){if(b.browser.msie){o=this.getRangeAt().getBookmark()}};this.restoreIERange=function(){b.browser.msie&&o&&this.getRangeAt().moveToBookmark(o)};this.cloneContents=function(){var w=this.rte.dom.create("div"),t,v,q;if(b.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(u){t=this.rte.doc.body.createTextRange()}b(w).html(t.htmlText)}else{v=this.getRangeAt().cloneContents();for(q=0;q<v.childNodes.length;q++){w.appendChild(v.childNodes[q].cloneNode(true))}}return w};this.select=function(u,x){x=x||u;if(this.rte.browser.msie){var v=this.rte.doc.body.createTextRange(),t=v.duplicate(),q=v.duplicate();t.moveToElementText(u);q.moveToElementText(x);v.setEndPoint("StartToStart",t);v.setEndPoint("EndToEnd",q);v.select()}else{var w=j(),v=this.getRangeAt();v.setStartBefore(u);v.setEndAfter(x);w.removeAllRanges();w.addRange(v)}return this.cleanCache()};this.selectContents=function(v){var t=this.getRangeAt();if(v&&v.nodeType==1){if(this.rte.browser.msie){t.range();t.r.moveToElementText(v.parentNode);t.r.select()}else{try{t.selectNodeContents(v)}catch(u){return this.rte.log("unable select node contents "+v)}var q=j();q.removeAllRanges();q.addRange(t)}}return this};this.insertNode=function(w,v){if(v&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){var q=w.nodeType==3?w.nodeValue:b(this.rte.dom.create("span")).append(b(w)).html();var u=this.getRangeAt();u.insertNode(q)}else{var u=this.getRangeAt();u.insertNode(w);u.setStartAfter(w);u.setEndAfter(w);var t=j();t.removeAllRanges();t.addRange(u)}return this.cleanCache()};this.insertHtml=function(q,r){if(r&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){this.getRangeAt().range().pasteHTML(q)}else{var t=b(this.rte.dom.create("span")).html(q||"").get(0);this.insertNode(t);b(t).replaceWith(b(t).html())}return this.cleanCache()};this.insertText=function(r,q){var t=this.rte.doc.createTextNode(r);return this.insertHtml(t.nodeValue)};this.getBookmark=function(){this.rte.window.focus();var w,u,t,A,q,v=this.rte.dom.createBookmark(),z=this.rte.dom.createBookmark();if(b.browser.msie){try{w=this.rte.window.document.selection.createRange()}catch(z){w=this.rte.doc.body.createTextRange()}u=w.duplicate();t=w.duplicate();A=this.rte.dom.create("span");q=this.rte.dom.create("span");A.appendChild(v);q.appendChild(z);u.collapse(true);u.pasteHTML(A.innerHTML);t.collapse(false);t.pasteHTML(q.innerHTML)}else{var x=j();var w=x.rangeCount>0?x.getRangeAt(0):this.rte.doc.createRange();u=w.cloneRange();t=w.cloneRange();t.collapse(false);t.insertNode(z);u.collapse(true);u.insertNode(v);this.select(v,z)}return[v.id,z.id]};this.moveToBookmark=function(q){this.rte.window.focus();if(q&&q.length==2){var t=this.rte.doc.getElementById(q[0]),w=this.rte.doc.getElementById(q[1]),v,u;if(t&&w){this.select(t,w);if(this.rte.dom.next(t)==w){this.collapse(true)}if(!b.browser.msie){v=j();u=v.rangeCount>0?v.getRangeAt(0):this.rte.doc.createRange();v.removeAllRanges();v.addRange(u)}t.parentNode.removeChild(t);w.parentNode.removeChild(w)}}return this};this.removeBookmark=function(q){this.rte.window.focus();if(q.length==2){var r=this.rte.doc.getElementById(q[0]),t=this.rte.doc.getElementById(q[1]);if(r&&t){r.parentNode.removeChild(r);t.parentNode.removeChild(t)}}};this.cleanCache=function(){p=c=k=null;return this};this.getStart=function(){if(!p){var q=this.getRangeAt();p=q.getStart()}return p};this.getEnd=function(){if(!c){var q=this.getRangeAt();c=q.getEnd()}return c};this.getNode=function(){if(!k){k=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())}return k};this.selected=function(t){var q={collapsed:false,blocks:false,filter:false,wrap:"text",tag:"span"};q=b.extend({},q,t);if(q.blocks){var w=this.getNode(),v=null;if(v=this.rte.dom.selfOrParent(w,"selectionBlock")){return[v]}}var u=this.selectedRaw(q.collapsed,q.blocks);var B=[];var x=[];var C=null;function r(){function E(){for(var G=0;G<x.length;G++){if(x[G].nodeType==1&&(d.rte.dom.selfOrParent(x[G],/^P$/)||b(x[G]).find("p").length>0)){return false}}return true}if(x.length>0){var D=q.tag=="p"&&!E()?"div":q.tag;var F=d.rte.dom.wrap(x,D);B[C]=F;C=null;x=[]}}function A(F){if(F.nodeType==1){if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(F.nodeName)){b(F).find("td,th").each(function(){var G=q.tag=="p"&&b(this).find("p").length>0?"div":q.tag;var H=d.rte.dom.wrapContents(this,G);return B.push(H)})}else{if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(F.nodeName)){var D=q.tag=="p"&&b(F).find("p").length>0?"div":q.tag;var F=d.rte.dom.wrapContents(F,D);return B.push(F)}}}var E=x.length>0?x[x.length-1]:null;if(E&&E!=d.rte.dom.prev(F)){r()}x.push(F);if(C===null){C=B.length;B.push("dummy")}}if(u.nodes.length>0){for(var z=0;z<u.nodes.length;z++){var w=u.nodes[z];if(w.nodeType==3&&(z==0||z==u.nodes.length-1)&&b.trim(w.nodeValue).length>0){if(z==0&&u.so>0){w=w.splitText(u.so)}if(z==u.nodes.length-1&&u.eo>0){w.splitText(z==0&&u.so>0?u.eo-u.so:u.eo)}}switch(q.wrap){case"text":if((w.nodeType==1&&w.nodeName=="BR")||(w.nodeType==3&&b.trim(w.nodeValue).length>0)){A(w)}else{if(w.nodeType==1){B.push(w)}}break;case"inline":if(this.rte.dom.isInline(w)){A(w)}else{if(w.nodeType==1){B.push(w)}}break;case"all":if(w.nodeType==1||!this.rte.dom.isEmpty(w)){A(w)}break;default:if(w.nodeType==1||!this.rte.dom.isEmpty(w)){B.push(w)}}}r()}if(B.length){this.rte.window.focus();this.select(B[0],B[B.length-1])}return q.filter?this.rte.dom.filter(B,q.filter):B};this.dump=function(q,u,x,w,t){var v=this.getRangeAt();this.rte.log("commonAncestorContainer");this.rte.log(q||v.commonAncestorContainer);this.rte.log("startContainer");this.rte.log(u||v.startContainer);this.rte.log("startOffset: "+(w>=0?w:v.startOffset));this.rte.log("endContainer");this.rte.log(x||v.endContainer);this.rte.log("endOffset: "+(t>=0?t:v.endOffset))};this.selectedRaw=function(A,q){var G={so:null,eo:null,nodes:[]};var t=this.getRangeAt(true);var x=t.commonAncestorContainer;var I,F;var E=false;var C=false;function D(K,r,J){if(K.nodeType==3){J=J>=0?J:K.nodeValue.length;return(r==0&&J==K.nodeValue.length)||b.trim(K.nodeValue).length==b.trim(K.nodeValue.substring(r,J)).length}return true}function z(K,r,J){if(K.nodeType==1){return d.rte.dom.isEmpty(K)}else{if(K.nodeType==3){return b.trim(K.nodeValue.substring(r||0,J>=0?J:K.nodeValue.length)).length==0}}return true}if(t.startContainer.nodeType==1){if(t.startOffset<t.startContainer.childNodes.length){I=t.startContainer.childNodes[t.startOffset];G.so=I.nodeType==1?null:0}else{I=t.startContainer.childNodes[t.startOffset-1];G.so=I.nodeType==1?null:I.nodeValue.length}}else{I=t.startContainer;G.so=t.startOffset}if(t.collapsed){if(A){if(q){I=g(I);if(!this.rte.dom.isEmpty(I)||(I=this.rte.dom.next(I))){G.nodes=[I]}if(this.rte.dom.isInline(I)){G.nodes=this.rte.dom.toLineStart(I).concat(G.nodes,this.rte.dom.toLineEnd(I))}if(G.nodes.length>0){G.so=G.nodes[0].nodeType==1?null:0;G.eo=G.nodes[G.nodes.length-1].nodeType==1?null:G.nodes[G.nodes.length-1].nodeValue.length}}else{if(!this.rte.dom.isEmpty(I)){G.nodes=[I]}}}return G}if(t.endContainer.nodeType==1){F=t.endContainer.childNodes[t.endOffset-1];G.eo=F.nodeType==1?null:F.nodeValue.length}else{F=t.endContainer;G.eo=t.endOffset}if(I.nodeType==1||q||D(I,G.so,I.nodeValue.length)){I=g(I,x,"left");E=true;G.so=I.nodeType==1?null:0}if(F.nodeType==1||q||D(F,0,G.eo)){F=g(F,x,"right");C=true;G.eo=F.nodeType==1?null:F.nodeValue.length}if(q){if(I.nodeType!=1&&I.parentNode!=x&&I.parentNode.nodeName!="BODY"){I=I.parentNode;G.so=null}if(F.nodeType!=1&&F.parentNode!=x&&F.parentNode.nodeName!="BODY"){F=F.parentNode;G.eo=null}}if(I.parentNode==F.parentNode&&I.parentNode.nodeName!="BODY"&&(E&&this.rte.dom.isFirstNotEmpty(I))&&(C&&this.rte.dom.isLastNotEmpty(F))){I=F=I.parentNode;G.so=I.nodeType==1?null:0;G.eo=F.nodeType==1?null:F.nodeValue.length}if(I==F){if(!this.rte.dom.isEmpty(I)){G.nodes.push(I)}return G}var u=I;while(u.nodeName!="BODY"&&u.parentNode!==x&&u.parentNode.nodeName!="BODY"){u=u.parentNode}var H=F;while(H.nodeName!="BODY"&&H.parentNode!==x&&H.parentNode.nodeName!="BODY"){H=H.parentNode}if(!z(I,G.so,I.nodeType==3?I.nodeValue.length:null)){G.nodes.push(I)}var w=I;while(w!==u){var v=w;while((v=this.rte.dom.next(v))){G.nodes.push(v)}w=w.parentNode}w=u;while((w=this.rte.dom.next(w))&&w!=H){G.nodes.push(w)}var B=[];w=F;while(w!==H){var v=w;while((v=this.rte.dom.prev(v))){B.push(v)}w=w.parentNode}if(B.length){G.nodes=G.nodes.concat(B.reverse())}if(!z(F,0,F.nodeType==3?G.eo:null)){G.nodes.push(F)}if(q){if(this.rte.dom.isInline(I)){G.nodes=this.rte.dom.toLineStart(I).concat(G.nodes);G.so=G.nodes[0].nodeType==1?null:0}if(this.rte.dom.isInline(F)){G.nodes=G.nodes.concat(this.rte.dom.toLineEnd(F));G.eo=G.nodes[G.nodes.length-1].nodeType==1?null:G.nodes[G.nodes.length-1].nodeValue.length}}return G}}})(jQuery);(function(b){elRTE.prototype.ui=function(d){this.rte=d;this._buttons=[];var v=this,o=this.rte.options.toolbars[d.options.toolbar&&d.options.toolbars[d.options.toolbar]?d.options.toolbar:"normal"],r=o.length,g,k,j,h,t,u,q;for(q in this.buttons){if(this.buttons.hasOwnProperty(q)&&q!="button"){this.buttons[q].prototype=this.buttons.button.prototype}}while(r--){k=o[r];g=b('<ul class="panel-'+k+(r==0?" first":"")+'" />').prependTo(this.rte.toolbar);g.bind("mousedown",function(c){c.preventDefault()});j=this.rte.options.panels[k].length;while(j--){h=this.rte.options.panels[k][j];t=this.buttons[h]||this.buttons.button;this._buttons.push((u=new t(this.rte,h)));g.prepend(u.domElem)}}this.update();this.disable=function(){b.each(v._buttons,function(){!this.active&&this.domElem.addClass("disabled")})}};elRTE.prototype.ui.prototype.update=function(c){c&&this.rte.selection.cleanCache();var h=this.rte.selection.getNode(),g=this.rte.dom.parents(h,"*"),d="";if(g.length){b.each(g.reverse(),function(){d+=" &raquo; "+this.nodeName.toLowerCase()})}if(h&&h.nodeType==1&&h.nodeName!="BODY"){d+=" &raquo; "+h.nodeName.toLowerCase()}this.rte.statusbar.html(d);b.each(this._buttons,function(){this.update()});this.rte.window.focus()};elRTE.prototype.ui.prototype.buttons={button:function(g,d){var c=this;this.rte=g;this.active=false;this.name=d;this.val=null;this.domElem=b('<li style="-moz-user-select:-moz-none" class="'+d+' rounded-3" name="'+d+'" title="'+this.rte.i18n(this.rte.options.buttons[d]||d)+'" unselectable="on" />').hover(function(){b(this).addClass("hover")},function(){b(this).removeClass("hover")}).click(function(h){h.stopPropagation();h.preventDefault();if(!b(this).hasClass("disabled")){c.command()}c.rte.window.focus()})}};elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,false,this.val)}catch(c){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(true)};elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(!this.rte.doc.queryCommandEnabled(this.name)){return this.domElem.addClass("disabled")}else{this.domElem.removeClass("disabled")}}catch(c){return}try{if(this.rte.doc.queryCommandState(this.name)){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}catch(c){}}})(jQuery);(function(b){elRTE.prototype.utils=function(d){this.rte=d;this.url=null;this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;this.baseURL="";this.path="";var c=this;this.rgb2hex=function(j){function h(k){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !k?"00":hexDigits[(k-k%16)/16]+hexDigits[k%16]}var g=j.match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return g?"#"+h(g[1])+h(g[2])+h(g[3]):""};this.toPixels=function(h){var g=h.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(g){h=g[1];unit=g[2]}if(h[0]=="."){h="0"+h}h=parseFloat(h);if(isNaN(h)){return""}var j=parseInt(b(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(h*j);case"pt":return parseInt(h*j/12);case"%":return parseInt(h*j/100)}return h};this.absoluteURL=function(h){!this.url&&this._url();h=b.trim(h);if(!h){return""}if(h[0]=="#"){return h}var g=this.parseURL(h);if(!g.host&&!g.path&&!g.anchor){return""}if(!this.rte.options.absoluteURLs){return h}if(g.protocol){return h}if(g.host&&(g.host.indexOf(".")!=-1||g.host=="localhost")){return this.url.protocol+"://"+h}if(h[0]=="/"){h=this.baseURL+h}else{if(h.indexOf("./")==0){h=h.substring(2)}h=this.baseURL+this.path+h}return h};this.parseURL=function(j){var h=j.match(this.reg);var g={};b.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(k){g[this]=h[k]});if(!g.host.match(/[a-z0-9]/i)){g.host=""}return g};this.trimEventCallback=function(g){g=g?g.toString():"";return b.trim(g.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))};this._url=function(){this.url=this.parseURL(window.location.href);this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:"");this.path=!this.url.file?this.url.path:this.url.path.substring(0,this.url.path.length-this.url.file.length)}}})(jQuery);(function(b){elRTE.prototype.w3cRange=function(d){var c=this;this.rte=d;this.r=null;this.collapsed=true;this.startContainer=null;this.endContainer=null;this.startOffset=0;this.endOffset=0;this.commonAncestorContainer=null;this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(g){this.r=this.rte.doc.body.createTextRange()}return this.r};this.insertNode=function(g){this.range();c.r.collapse(false);var h=c.r.duplicate();h.pasteHTML(g)};this.getBookmark=function(){this.range();if(this.r.item){var g=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(g)}return this.r.getBookmark()};this.moveToBookmark=function(g){this.rte.window.focus();this.range().moveToBookmark(g);this.r.select()};this.update=function(){function j(z){var o="\uFEFF";var q=offset=0;var u=c.r.duplicate();u.collapse(z);var v=u.parentElement();if(!v||v.nodeName=="HTML"){return{parent:c.rte.doc.body,ndx:q,offset:offset}}u.pasteHTML(o);childs=v.childNodes;for(var t=0;t<childs.length;t++){var x=childs[t];if(t>0&&(x.nodeType!==3||childs[t-1].nodeType!==3)){q++}if(x.nodeType!==3){offset=0}else{var w=x.nodeValue.indexOf(o);if(w!==-1){offset+=w;break}offset+=x.nodeValue.length}}u.moveStart("character",-1);u.text="";return{parent:v,ndx:Math.min(q,v.childNodes.length-1),offset:offset}}this.range();this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=false;var h=this.r.item(0);this.setStart(h.parentNode,this.rte.dom.indexOf(h));this.setEnd(h.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var k=j(true);var g=j(false);k.parent.normalize();g.parent.normalize();k.ndx=Math.min(k.ndx,k.parent.childNodes.length-1);g.ndx=Math.min(g.ndx,g.parent.childNodes.length-1);if(k.parent.childNodes[k.ndx].nodeType&&k.parent.childNodes[k.ndx].nodeType==1){this.setStart(k.parent,k.ndx)}else{this.setStart(k.parent.childNodes[k.ndx],k.offset)}if(g.parent.childNodes[g.ndx].nodeType&&g.parent.childNodes[g.ndx].nodeType==1){this.setEnd(g.parent,g.ndx)}else{this.setEnd(g.parent.childNodes[g.ndx],g.offset)}this.select()}return this};this.isCollapsed=function(){this.range();this.collapsed=this.r.item?false:this.r.boundingWidth==0;return this.collapsed};this.collapse=function(g){this.range();if(this.r.item){var h=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(h)}this.r.collapse(g);this.r.select();this.collapsed=true};this.getStart=function(){this.range();if(this.r.item){return this.r.item(0)}var h=this.r.duplicate();h.collapse(true);var g=h.parentElement();return g&&g.nodeName=="BODY"?g.firstChild:g};this.getEnd=function(){this.range();if(this.r.item){return this.r.item(0)}var g=this.r.duplicate();g.collapse(false);var h=g.parentElement();return h&&h.nodeName=="BODY"?h.lastChild:h};this.setStart=function(g,h){this.startContainer=g;this.startOffset=h;if(this.endContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setEnd=function(g,h){this.endContainer=g;this.endOffset=h;if(this.startContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setStartBefore=function(g){if(g.parentNode){this.setStart(g.parentNode,this.rte.dom.indexOf(g))}};this.setStartAfter=function(g){if(g.parentNode){this.setStart(g.parentNode,this.rte.dom.indexOf(g)+1)}};this.setEndBefore=function(g){if(g.parentNode){this.setEnd(g.parentNode,this.rte.dom.indexOf(g))}};this.setEndAfter=function(g){if(g.parentNode){this.setEnd(g.parentNode,this.rte.dom.indexOf(g)+1)}};this.select=function(){function q(C,A){if(C.nodeType!=3){return -1}var B="\uFEFF";var z=C.nodeValue;var w=c.rte.doc.body.createTextRange();C.nodeValue=z.substring(0,A)+B+z.substring(A);w.moveToElementText(C.parentNode);w.findText(B);var x=Math.abs(w.moveStart("character",-1048575));C.nodeValue=z;return x}this.r=this.rte.doc.body.createTextRange();var o=this.startOffset;var h=this.endOffset;var v=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(o,this.startContainer.childNodes.length-1)]:this.startContainer;var t=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(o==h?h:h-1,this.endContainer.childNodes.length-1)]:this.endContainer;if(this.collapsed){if(v.nodeType==3){var j=q(v,o);this.r.move("character",j)}else{this.r.moveToElementText(v);this.r.collapse(true)}}else{var g=this.rte.doc.body.createTextRange();var k=q(v,o);var u=q(t,h);if(v.nodeType==3){this.r.move("character",k)}else{this.r.moveToElementText(v)}if(t.nodeType==3){g.move("character",u)}else{g.moveToElementText(t)}this.r.setEndPoint("EndToEnd",g)}try{this.r.select()}catch(t){}if(g){g=null}};this.dump=function(){this.rte.log("collapsed: "+this.collapsed);this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non"));this.rte.log("startOffset: "+this.startOffset);this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none"));this.rte.log("endOffset: "+this.endOffset)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.anchor=function(g,d){this.constructor.prototype.constructor.call(this,g,d);this.input=b('<input type="text" />').attr("name","anchor").attr("size","16");var c=this;this.command=function(){var h={submit:function(k,o){k.stopPropagation();k.preventDefault();o.close();c.set()},dialog:{title:this.rte.i18n("Bookmark")}};this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||g.dom.create("a");!this.rte.selection.collapsed()&&this.rte.selection.collapse(false);this.input.val(b(this.anchor).addClass("el-rte-anchor").attr("name"));this.rte.selection.saveIERange();var j=new elDialogForm(h);j.append([this.rte.i18n("Bookmark name"),this.input],null,true).open();setTimeout(function(){c.input.focus()},20)};this.update=function(){var h=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(h)){this.domElem.addClass("disabled")}else{if(this.rte.dom.selfOrParentAnchor(h)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.removeClass("disabled").removeClass("active")}}};this.set=function(){var h=b.trim(this.input.val());if(h){this.rte.history.add();if(!this.anchor.parentNode){this.rte.selection.insertHtml('<a name="'+h+'" title="'+this.rte.i18n("Bookmark")+": "+h+'" class="el-rte-anchor"></a>')}else{this.anchor.name=h;this.anchor.title=this.rte.i18n("Bookmark")+": "+h}}else{if(this.anchor.parentNode){this.rte.history.add();this.anchor.parentNode.removeChild(this.anchor)}}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.blockquote=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){var h,g;this.rte.history.add();if(this.rte.selection.collapsed()&&(h=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))){b(h).replaceWith(b(h).html())}else{g=this.rte.selection.selected({wrap:"all",tag:"blockquote"});g.length&&this.rte.selection.select(g[0],g[g.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.copy=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){if(this.rte.browser.mozilla){try{this.rte.doc.execCommand(this.name,false,null)}catch(j){var g=" Ctl + C";if(this.name=="cut"){g=" Ctl + X"}else{if(this.name=="paste"){g=" Ctl + V"}}var h={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){b(this).dialog("close")}}}};var k=new elDialogForm(h);k.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+g).open()}}else{this.constructor.prototype.command.call(this)}}};elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy;elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.css=function(g,d){var c=this;this.constructor.prototype.constructor.call(this,g,d);this.cssStyle=b('<input type="text" size="42" name="style" />');this.cssClass=b('<input type="text" size="42" name="class" />');this.command=function(){var k=this.node(),h;this.rte.selection.saveIERange();if(k){var h={submit:function(o,p){o.stopPropagation();o.preventDefault();p.close();c.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:true,modal:true}};this.cssStyle.val(b(k).attr("style"));this.cssClass.val(b(k).attr("class"));var j=new elDialogForm(h);j.append([this.rte.i18n("Css style"),this.cssStyle],null,true);j.append([this.rte.i18n("Css class"),this.cssClass],null,true).open();setTimeout(function(){c.cssStyle.focus()},20)}};this.set=function(){var h=this.node();this.rte.selection.restoreIERange();if(h){b(h).attr("style",this.cssStyle.val());b(h).attr("class",this.cssClass.val());this.rte.ui.update()}};this.node=function(){var h=this.rte.selection.getNode();if(h.nodeType==3){h=h.parentNode}return h.nodeType==1&&h.nodeName!="BODY"?h:null};this.update=function(){this.domElem.toggleClass("disabled",this.node()?false:true)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.div=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){var h,g;this.rte.history.add();if(this.rte.selection.collapsed()){h=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/);if(h){b(h).replaceWith(b(h).html())}}else{g=this.rte.selection.selected({wrap:"all",tag:"div"});g.length&&this.rte.selection.select(g[0],g[g.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.docstructure=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){this.domElem.toggleClass("active");b(this.rte.doc.body).toggleClass("el-rte-structure")};this.command();this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.elfinder=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){if(c.rte.options.fmAllow&&typeof(c.rte.options.fmOpen)=="function"){c.rte.options.fmOpen(function(h){c.rte.log(h)})}};this.update=function(){if(c.rte.options.fmAllow&&typeof(c.rte.options.fmOpen)=="function"){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.flash=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.swf=null;this.placeholder=null;this.src={url:b('<input type="text" name="url" />').css("width","99%"),width:b('<input type="text" />').attr("size",5).css("text-align","right"),height:b('<input type="text" />').attr("size",5).css("text-align","right"),align:b("<select />").css("width","100%").append(b("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(b("<option />").val("left").text(this.rte.i18n("Left"))).append(b("<option />").val("right").text(this.rte.i18n("Right"))).append(b("<option />").val("top").text(this.rte.i18n("Top"))).append(b("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(b("<option />").val("middle").text(this.rte.i18n("middle"))).append(b("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(b("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(b("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:b("<div />")};this.command=function(){var q=this.rte.selection.getEnd(),k,o="",z="",r="",u,x,v;this.src.margin.elPaddingInput({type:"margin"});this.placeholder=null;this.swf=null;if(b(q).hasClass("elrte-swf-placeholder")){this.placeholder=b(q);o=b(q).attr("rel");z=parseInt(b(q).css("width"))||"";r=parseInt(b(q).css("height"))||"";u=b(q).css("float");x=b(q).css("vertical-align");this.src.margin.val(q)}this.src.url.val(o);this.src.width.val(z);this.src.height.val(r);this.src.align.val(u||x);var k={submit:function(h,w){h.stopPropagation();h.preventDefault();c.set();w.close()},dialog:{width:550,position:"top",title:this.rte.i18n("Flash")}};var v=new elDialogForm(k);if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var j=b("<span />").append(this.src.url.css("width","85%")).append(b("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",c.rte.i18n("Open file manger")).append(b("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){c.rte.options.fmOpen(function(h){c.src.url.val(h).change()})}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}))}else{var j=this.src.url}v.append([this.rte.i18n("URL"),j],null,true);v.append([this.rte.i18n("Size"),b("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,true);v.append([this.rte.i18n("Alignment"),this.src.align],null,true);v.append([this.rte.i18n("Margins"),this.src.margin],null,true);v.open();setTimeout(function(){c.src.url.focus()},100);var t=b("<fieldset />").append(b("<legend />").text(this.rte.i18n("Preview")));v.append(t,"main");var p=document.createElement("iframe");b(p).attr("src","#").addClass("el-rte-preview").appendTo(t);html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin</body></html>';p.contentWindow.document.open();p.contentWindow.document.write(html);p.contentWindow.document.close();this.frame=p.contentWindow.document;this.preview=b(p.contentWindow.document.body);this.src.width.change(function(){if(c.swf){var h=parseInt(b(this).val())||"";b(this).val(h);c.swf.css("width",h);c.swf.children("embed").css("width",h)}else{b(this).val("")}});this.src.height.change(function(){if(c.swf){var w=parseInt(b(this).val())||"";b(this).val(w);c.swf.css("height",z);c.swf.children("embed").css("height",w)}else{b(this).val("")}});this.src.align.change(function(){var h=b(this).val(),w=h=="left"||h=="right";if(c.swf){c.swf.css({"float":w?h:"","vertical-align":w?"":h})}else{b(this).val("")}});this.src.margin.change(function(){if(c.swf){var h=c.src.margin.val();if(h.css){c.swf.css("margin",h.css)}else{c.swf.css("margin-top",h.top);c.swf.css("margin-right",h.right);c.swf.css("margin-bottom",h.bottom);c.swf.css("margin-left",h.left)}}});this.src.url.change(function(){var h=c.rte.utils.absoluteURL(b(this).val());if(h){var w='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" style="border:1px solid #111"><param name="quality" value="high" /><param name="movie" value="'+h+'" /><embed pluginspage="http://www.macromedia.com/go/getflashplayer" quality="high" src="'+h+'" type="application/x-shockwave-flash"></embed></object>';c.preview.prepend(w);c.swf=c.preview.children("object").eq(0)}else{if(c.swf){c.swf.remove();c.swf=null}}c.src.width.trigger("change");c.src.height.trigger("change");c.src.align.trigger("change")}).trigger("change")};this.set=function(){c.swf=null;var o=this.rte.utils.absoluteURL(this.src.url.val()),k=parseInt(this.src.width.val())||"auto",q=parseInt(this.src.height.val())||"auto";a=this.src.align.val(),f=a=="left"||a=="right"?a:"";if(o){var j=this.src.margin.val(),p={width:k,height:q,"float":f,"vertical-align":f?"":a};if(j.css){p.margin=j.css}else{p["margin-top"]=j.top;p["margin-right"]=j.right;p["margin-bottom"]=j.bottom;p["margin-left"]=j.left}if(c.placeholder){c.placeholder.css(p).attr("rel",o)}else{this.placeholder=b(this.rte.dom.create("img")).attr("src",this.rte.filter.swfSrc).attr("rel",o).css(p).addClass("elrte-swf-placeholder");this.rte.selection.insertNode(this.placeholder.get(0))}}else{if(c.placeholder){c.placeholder.remove()}}};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getNode();this.domElem.toggleClass("active",h.nodeName=="IMG"&&b(h).hasClass("elrte-swf-placeholder"))}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fontname=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;var h={tpl:'<span style="font-family:%val">%label</span>',select:function(j){c.set(j)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};this.select=this.domElem.elSelect(h);this.command=function(){};this.set=function(k){this.rte.history.add();var j=this.rte.selection.selected({filter:"textContainsNodes"});b.each(j,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?b(this).find("td,th"):b(this);b(this).css("font-family",k).find("[style]").css("font-family","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var k=this.rte.selection.getNode();if(k.nodeType!=1){k=k.parentNode}var j=b(k).css("font-family");j=j?j.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"";this.select.val(h.src[j]?j:"")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fontsize=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;var h={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',select:function(j){c.set(j)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};this.select=this.domElem.elSelect(h);this.command=function(){};this.set=function(k){this.rte.history.add();var j=this.rte.selection.selected({filter:"textContainsNodes"});b.each(j,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?b(this).find("td,th"):b(this);$this.css("font-size",k).find("[style]").css("font-size","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var j=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(j,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.forecolor=function(g,d){var c=this;this.constructor.prototype.constructor.call(this,g,d);var h={"class":"",color:this.defaultColor,update:function(j){c.indicator.css("background-color",j)},change:function(j){c.set(j)}};this.defaultColor=this.rte.utils.rgb2hex(b(this.rte.doc.body).css(this.name=="forecolor"?"color":"background-color"));this.picker=this.domElem.elColorPicker(h);this.indicator=b("<div />").addClass("color-indicator").prependTo(this.domElem);this.command=function(){};this.set=function(o){if(!this.rte.selection.collapsed()){this.rte.history.add();var j=this.rte.selection.selected({collapse:false,wrap:"text"}),k=this.name=="forecolor"?"color":"background-color";b.each(j,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){b(this).find("td,th").each(function(){b(this).css(k,o).find("*").css(k,"")})}else{b(this).css(k,o).find("*").css(k,"")}});this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled");var k=this.rte.selection.getNode();if(k.nodeType!=1){k=k.parentNode}var j=b(k).css(this.name=="forecolor"?"color":"background-color");this.picker.val(j&&j!="transparent"?this.rte.utils.rgb2hex(j):this.defaultColor)}};elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.formatblock=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var j=this.rte.browser.msie?function(k){c.val=k;c.constructor.prototype.command.call(c)}:function(k){c.ieCommand(k)};var c=this;var h={labelTpl:"%label",tpls:{"":"%label"},select:function(k){c.formatBlock(k)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(h);this.command=function(){};this.formatBlock=function(w){function u(A,v){function z(B){b(B).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){b(this).replaceWith(b(this).html())});return B}if(/^(LI|DT|DD|TD|TH|CAPTION)$/.test(A.nodeName)){!c.rte.dom.isEmpty(A)&&c.rte.dom.wrapContents(z(A),v)}else{if(/^(UL|OL|DL|TABLE)$/.test(A.nodeName)){c.rte.dom.wrap(A,v)}else{!c.rte.dom.isEmpty(A)&&b(z(A)).replaceWith(b(c.rte.dom.create(v)).html(b(A).html()))}}}this.rte.history.add();var x=w.toUpperCase(),q,p,t,r=this.rte.selection.collapsed(),o=this.rte.selection.getBookmark(),k=this.rte.selection.selected({collapsed:true,blocks:true,filter:"textContainsNodes",wrap:"inline",tag:"span"});l=k.length,s=b(k[0]).prev(),e=b(k[k.length-1]).next();while(l--){p=k[l];t=b(p);if(x=="DIV"||x=="SPAN"){if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(p.nodeName)){t.replaceWith(b(this.rte.dom.create("div")).html(t.html()||""))}}else{if(/^(THEAD|TBODY|TFOOT|TR)$/.test(p.nodeName)){t.find("td,th").each(function(){u(this,x)})}else{if(p.nodeName!=x){u(p,x)}}}}this.rte.selection.moveToBookmark(o);this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");var k=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);this.select.val(k?k.nodeName.toLowerCase():"span")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.fullscreen=function(g,d){this.constructor.prototype.constructor.call(this,g,d);this.active=true;this.parents=[];this.height=0;var c=this;this.command=function(){if(this.rte.editor.hasClass("el-fullscreen")){for(var j=0;j<this.parents.length;j++){b(this.parents[j]).css("position","relative")}this.parents=[];this.rte.editor.removeClass("el-fullscreen");this.rte.workzone.add(this.rte.iframe).height(this.height);this.domElem.removeClass("active")}else{this.parents=[];var o=this.rte.editor.parents().each(function(){if(this.nodeName!="BODY"&&this.name!="HTML"&&b(this).css("position")=="relative"){c.parents.push(this);b(this).css("position","static")}});this.height=this.rte.workzone.height();this.rte.editor.addClass("el-fullscreen");var k=parseInt(this.rte.editor.height()-this.rte.toolbar.height()-this.rte.statusbar.height()-this.rte.tabsbar.height()-17);k>0&&this.rte.workzone.add(this.rte.iframe).height(k);this.domElem.addClass("active")}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.src={width:b('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:b("<select />").attr("name","wunit").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")).val("%"),height:b('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:b("<div />"),border:b("<div />"),"class":b('<input type="text" />').css("width","100%"),style:b('<input type="text" />').css("width","100%")};this.command=function(){this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});var o=this.rte.selection.getEnd();this.hr=o.nodeName=="HR"?b(o):b(g.doc.createElement("hr")).css({width:"100%",height:"1px"});this.src.border.elBorderSelect({styleHeight:73,value:this.hr});var h=this.hr.css("width")||this.hr.attr("width");this.src.width.val(parseInt(h)||100);this.src.wunit.val(h.indexOf("px")!=-1?"px":"%");this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1);this.src.bg.val(this.rte.utils.rgb2hex(this.hr.css("background-color"))||"");this.src["class"].val(this.rte.dom.attr(this.hr,"class"));this.src.style.val(this.rte.dom.attr(this.hr,"style"));var j={submit:function(p,q){p.stopPropagation();p.preventDefault();c.set();q.close()},dialog:{title:this.rte.i18n("Horizontal rule")}};var k=new elDialogForm(j);k.append([this.rte.i18n("Width"),b("<span />").append(this.src.width).append(this.src.wunit)],null,true).append([this.rte.i18n("Height"),b("<span />").append(this.src.height).append(" px")],null,true).append([this.rte.i18n("Border"),this.src.border],null,true).append([this.rte.i18n("Background"),this.src.bg],null,true).append([this.rte.i18n("Css class"),this.src["class"]],null,true).append([this.rte.i18n("Css style"),this.src.style],null,true).open()};this.update=function(){this.domElem.removeClass("disabled");if(this.rte.selection.getEnd().nodeName=="HR"){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}};this.set=function(){this.rte.history.add();!this.hr.parentNode&&this.rte.selection.insertNode(this.hr.get(0));var j={noshade:true,style:this.src.style.val()};var h=this.src.border.val();var k={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:h.width&&h.style?h.width+" "+h.style+" "+h.color:""};this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(j).css(k);if(this.src["class"].val()){this.hr.attr("class",this.src["class"].val())}this.rte.ui.update()}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.image=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.img=null;this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"};this.src={main:{src:b('<input type="text" />').css("width","100%"),title:b('<input type="text" />').css("width","100%"),alt:b('<input type="text" />').css("width","100%"),width:b('<input type="text" />').attr("size",5).css("text-align","right"),height:b('<input type="text" />').attr("size",5).css("text-align","right"),margin:b("<div />"),align:b("<select />").css("width","100%").append(b("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(b("<option />").val("left").text(this.rte.i18n("Left"))).append(b("<option />").val("right").text(this.rte.i18n("Right"))).append(b("<option />").val("top").text(this.rte.i18n("Top"))).append(b("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(b("<option />").val("middle").text(this.rte.i18n("middle"))).append(b("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(b("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(b("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),border:b("<div />")},adv:{id:b('<input type="text" />').css("width","100%"),"class":b('<input type="text" />').css("width","100%"),style:b('<input type="text" />').css("width","100%"),longdesc:b('<input type="text" />').css("width","100%")},events:{}};b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){c.src.events[this]=b('<input type="text" />').css("width","100%")});b.each(c.src,function(){for(var h in this){this[h].attr("name",h)}})};this.command=function(){!this.src&&this.init();this.rte.browser.msie&&this.rte.selection.saveIERange();this.src.main.border.elBorderSelect({change:function(){c.updateImg()},name:"border"});this.src.main.margin.elPaddingInput({type:"margin"});this.cleanValues();this.src.main.src.val("");var p=this.rte.selection.getEnd();this.preview=null;this.prevImg=null;this.link=null;if(p.nodeName=="IMG"&&!b(p).hasClass("elrte-swf-placeholder")){this.img=b(p)}else{this.img=b(this.rte.doc.createElement("img"))}var j={submit:function(w,x){w.stopPropagation();w.preventDefault();c.set();x.close()},dialog:{width:520,position:"top",title:this.rte.i18n("Image")}};var u=new elDialogForm(j);if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var h=b("<span />").append(this.src.main.src.css("width","88%")).append(b("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",c.rte.i18n("Open file manger")).append(b("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){c.rte.options.fmOpen(function(w){c.src.main.src.val(w).change()})}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}))}else{var h=this.src.main.src}u.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),h],"main",true).append([this.rte.i18n("Title"),this.src.main.title],"main",true).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",true).append([this.rte.i18n("Size"),b("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true);for(var q in this.src){if(q!="main"){u.tab(q,this.rte.i18n(this.labels[q]));for(var k in this.src[q]){var r=this.rte.i18n(this.labels[k]?this.labels[k]:k);if(q=="events"){this.src[q][k].val(this.rte.utils.trimEventCallback(this.img.attr(k)))}else{if(q=="link"){if(this.link){this.src[q][k].val(k=="href"?this.rte.utils.absoluteURL(this.link.attr(k)):this.link.attr(k))}}else{this.src[q][k].val(this.img.attr(k)||"")}}u.append([r,this.src[q][k]],q,true)}}}u.open();var t=b("<fieldset />").append(b("<legend />").text(this.rte.i18n("Preview")));u.append(t,"main");var o=document.createElement("iframe");b(o).attr("src","#").addClass("el-rte-preview").appendTo(t);html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> </body></html>';o.contentWindow.document.open();o.contentWindow.document.write(html);o.contentWindow.document.close();this.frame=o.contentWindow.document;this.preview=b(o.contentWindow.document.body).text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin");if(this.img.attr("src")){this.prevImg=b(this.frame.createElement("img")).attr("src",this.rte.utils.absoluteURL(this.img.attr("src")));this.prevImg.attr("width",this.img.attr("width")).attr("height",this.img.attr("height")).attr("title",this.img.attr("title")||"").attr("alt",this.img.attr("alt")||"").attr("style",this.img.attr("style")||"");for(var p in this.src.adv){var v=this.img.attr(p);if(v){this.prevImg.attr(p,v)}}this.preview.prepend(this.prevImg);this.updateValues()}b.each(this.src,function(){b.each(this,function(){if(this===c.src.main.src){this.bind("change",function(){c.updatePreview()})}else{if(this==c.src.main.width||this==c.src.main.height){this.bind("change",function(w){c.updateDimesions(w)})}else{this.bind("change",function(){c.updateImg()})}}})})};this.updateValues=function(){var h=this.prevImg.get(0);this.origW=this.prevImg.attr("width");this.origH=this.prevImg.attr("height");this.src.main.src.val(this.rte.dom.attr(h,"src"));this.src.main.title.val(this.rte.dom.attr(h,"title"));this.src.main.alt.val(this.rte.dom.attr(h,"alt"));this.src.main.width.val(this.origW);this.src.main.height.val(this.origH);this.src.adv["class"].val(this.rte.dom.attr(h,"class"));this.src.main.margin.val(this.prevImg);var j=this.prevImg.css("float");this.src.main.align.val(j=="left"||j=="right"?j:(this.prevImg.css("vertical-align")||""));this.src.main.border.val(this.prevImg);this.src.adv.style.val(this.rte.dom.attr(h,"style"))};this.cleanValues=function(){b.each(this.src,function(){b.each(this,function(){var h=b(this);if(h.attr("name")!="src"){h.val("")}})})};this.updateImg=function(){this.prevImg.attr({style:b.trim(this.src.adv.style.val()),title:b.trim(this.src.main.title.val()),alt:b.trim(this.src.main.alt.val()),width:parseInt(this.src.main.width.val()),height:parseInt(this.src.main.height.val())});var k=this.src.main.align.val();var o=k=="left"||k=="right"?k:"";var j=this.src.main.border.val();var h=this.src.main.margin.val();this.prevImg.css("float",o);this.prevImg.css("vertical-align",o?"":k);this.prevImg.css("border",b.trim(j.width+" "+j.style+" "+j.color));if(h.css){this.prevImg.css("margin",h.css)}else{this.prevImg.css("margin-top",h.top);this.prevImg.css("margin-right",h.right);this.prevImg.css("margin-bottom",h.bottom);this.prevImg.css("margin-left",h.left)}b.each([this.src.events,this.src.adv],function(){b.each(this,function(){var q=b(this);var r=q.attr("name");if(r!="style"){var p=b.trim(q.val());if(p){c.prevImg.attr(r,p)}else{c.prevImg.removeAttr(r)}}})})};this.updatePreview=function(){var j=this.prevImg?this.prevImg.attr("src"):"";var h=b.trim(this.src.main.src.val());if(!h||h!=j){if(this.prevImg){this.prevImg.remove();this.prevImg=null}this.cleanValues();if(h){this.prevImg=b(this.frame.createElement("img")).attr("src",this.rte.utils.absoluteURL(h)).bind("load",function(){c.updateValues()});this.preview.prepend(this.prevImg);c.updateValues()}}else{this.updateImg()}};this.updateDimesions=function(o){var j=parseInt(this.src.main.width.val())||0;var k=parseInt(this.src.main.height.val())||0;if(j>0&&k>0){if(o.currentTarget==this.src.main.width.get(0)){this.src.main.height.val(parseInt(j*this.origH/this.origW))}else{this.src.main.width.val(parseInt(k*this.origW/this.origH))}}else{this.src.main.width.val(this.origW);this.src.main.height.val(this.origH)}this.updateImg()};this.set=function(){this.rte.history.add();if(!this.prevImg||!this.prevImg.attr("width")){this.img&&this.img.remove();this.link&&this.rte.doc.execCommand("unlink",false,null)}else{if(!this.img.parents().length){this.rte.browser.msie&&this.rte.selection.restoreIERange();this.img=b(this.rte.doc.createElement("img"))}this.img.attr({src:this.rte.utils.absoluteURL(b.trim(this.src.main.src.val())),style:b.trim(this.rte.dom.attr(this.prevImg.get(0),"style")),title:b.trim(this.src.main.title.val()),alt:b.trim(this.src.main.alt.val()),width:parseInt(this.src.main.width.val()),height:parseInt(this.src.main.height.val())});for(var h in this.src.adv){if(h!="style"){var j=this.src.adv[h].val();if(j){this.img.attr(h,j)}else{this.img.removeAttr(h)}}}for(var h in this.src.events){var j=this.src.events[h].val();if(j){this.img.attr(h,j)}else{this.img.removeAttr(h)}}if(!this.img.parents().length){this.rte.selection.insertNode(this.img.get(0))}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getEnd();if(h.nodeName=="IMG"&&!b(h).hasClass("elrte-swf-placeholder")){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.indent=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){this.rte.history.add();var j=this.rte.selection.selected({collapsed:true,blocks:true,wrap:"inline",tag:"p"});function h(r){var p=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(r.nodeName)?"margin-left":"padding-left";var q=c.rte.dom.attr(r,"style").indexOf(p)!=-1?parseInt(b(r).css(p))||0:0;b(r).css(p,q+40+"px")}for(var k=0;k<j.length;k++){if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(j[k].nodeName)){b(j[k]).find("td,th").each(function(){h(this)})}else{if(/^LI$/.test(j[k].nodeName)){var o=b(j[k]);b(this.rte.dom.create(j[k].parentNode.nodeName)).append(b(this.rte.dom.create("li")).html(o.html()||"")).appendTo(o.html("&nbsp;"))}else{h(j[k])}}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.justifyleft=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.align=this.name=="justifyfull"?"justify":this.name.replace("justify","");this.command=function(){var h=this.rte.selection.selected({collapsed:true,blocks:true,tag:"div"}),g=h.length;g&&this.rte.history.add();while(g--){this.rte.dom.filter(h[g],"textNodes")&&b(h[g]).css("text-align",this.align)}this.rte.ui.update()};this.update=function(){var g=this.rte.selection.getNode(),h=g.nodeName=="BODY"?g:this.rte.dom.selfOrParent(g,"textNodes")||(g.parentNode&&g.parentNode.nodeName=="BODY"?g.parentNode:null);if(h){this.domElem.removeClass("disabled").toggleClass("active",b(h).css("text-align")==this.align)}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.link=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;function h(){c.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"};c.src={main:{href:b('<input type="text" />'),title:b('<input type="text" />'),anchor:b("<select />").attr("name","anchor"),target:b("<select />").append(b("<option />").text(c.rte.i18n("In this window")).val("")).append(b("<option />").text(c.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:b('<input type="checkbox />"'),url:b('<input type="text" />').val("http://"),name:b('<input type="text" />'),width:b('<input type="text" />').attr({size:6,title:c.rte.i18n("Width")}).css("text-align","right"),height:b('<input type="text" />').attr({size:6,title:c.rte.i18n("Height")}).css("text-align","right"),left:b('<input type="text" />').attr({size:6,title:c.rte.i18n("Left")}).css("text-align","right"),top:b('<input type="text" />').attr({size:6,title:c.rte.i18n("Top")}).css("text-align","right"),location:b('<input type="checkbox" />'),menubar:b('<input type="checkbox" />'),toolbar:b('<input type="checkbox" />'),scrollbars:b('<input type="checkbox" />'),status:b('<input type="checkbox" />'),resizable:b('<input type="checkbox" />'),dependent:b('<input type="checkbox" />'),retfalse:b('<input type="checkbox" />').attr("checked",true)},adv:{id:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").append(b("<option />").text(c.rte.i18n("Not set")).val("")).append(b("<option />").text(c.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(c.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />'),charset:b('<input type="text" />'),type:b('<input type="text" />'),rel:b('<input type="text" />'),rev:b('<input type="text" />'),tabindex:b('<input type="text" />'),accesskey:b('<input type="text" />')},events:{}};b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){c.src.events[this]=b('<input type="text" />')});b.each(c.src,function(){for(var k in this){this[k].attr("name",k);var j=this[k].attr("type");if(!j||(j=="text"&&!this[k].attr("size"))){this[k].css("width","100%")}}})}this.command=function(){var q=this.rte.selection.getNode();!this.src&&h();this.rte.browser.msie&&this.rte.selection.saveIERange();function t(r){return r.nodeName=="A"&&r.href}this.link=this.rte.dom.selfOrParentLink(q);if(!this.link){var p=b.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(p.length){for(var w=0;w<p.length;w++){if(t(p[w])){this.link=p[w];break}}if(!this.link){this.link=this.rte.dom.parent(p[0],t)||this.rte.dom.parent(p[p.length-1],t)}}}this.link=this.link?b(this.link):b(this.rte.doc.createElement("a"));this.updatePopup();this.src.main.anchor.empty();b('a[href!=""][name]',this.rte.doc).each(function(){var r=b(this).attr("name");c.src.main.anchor.append(b("<option />").val(r).text(r))});if(this.src.main.anchor.children().length){this.src.main.anchor.prepend(b("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var r=b(this).val();if(r){c.src.main.href.val("#"+r)}})}var j={submit:function(r,v){r.stopPropagation();r.preventDefault();c.set();v.close()},tabs:{show:function(v,r){if(r.index==3){c.updateOnclick()}}},close:function(){c.rte.browser.msie&&c.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}};var x=new elDialogForm(j);var u=b("<div />").append(b("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(b("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(b("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(b("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars")));var k=b("<div />").append(b("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(b("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(b("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(b("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false")));x.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(b("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",true).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",true).append([this.rte.i18n("Window size"),b("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",true).append([this.rte.i18n("Window position"),b("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",true).separator("popup").append([u,k],"popup",true);var z=this.link.get(0);var o=this.rte.dom.attr(z,"href");this.src.main.href.val(o).change(function(){b(this).val(c.rte.utils.absoluteURL(b(this).val()))});if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var B=b("<span />").append(this.src.main.href.css("width","87%")).append(b("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",c.rte.i18n("Open file manger")).append(b("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){c.rte.options.fmOpen(function(r){c.src.main.href.val(r).change()})}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}));x.append([this.rte.i18n("Link URL"),B],"main",true)}else{x.append([this.rte.i18n("Link URL"),this.src.main.href],"main",true)}this.src.main.href.change();x.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(z,"title"))],"main",true);if(this.src.main.anchor.children().length){x.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(o)],"main",true)}if(!this.rte.options.doctype.match(/xhtml/)){x.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",true)}for(var q in this.src.adv){this.src.adv[q].val(this.rte.dom.attr(z,q));x.append([this.rte.i18n(this.labels[q]?this.labels[q]:q),this.src.adv[q]],"adv",true)}for(var q in this.src.events){var A=this.rte.utils.trimEventCallback(this.rte.dom.attr(z,q));this.src.events[q].val(A);x.append([this.rte.i18n(this.labels[q]?this.labels[q]:q),this.src.events[q]],"events",true)}this.src.popup.use.change(function(){var r=b(this).attr("checked");b.each(c.src.popup,function(){if(b(this).attr("name")!="use"){if(r){b(this).removeAttr("disabled")}else{b(this).attr("disabled",true)}}})});this.src.popup.use.change();x.open();setTimeout(function(){c.src.main.href.focus()},20)};this.update=function(){var j=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(j)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(k){return k.nodeName=="A"&&k.href})){this.domElem.removeClass("disabled").addClass("active")}else{if(!this.rte.selection.collapsed()||j.nodeName=="IMG"){this.domElem.removeClass("disabled active")}else{this.domElem.addClass("disabled").removeClass("active")}}}};this.updatePopup=function(){var j=this.rte.dom.attr(this.link.get(0),"onclick");j=j?b.trim(j.toString()):"";if(j.length>0&&(m=j.match(/window.open\("([^"]+)",\s*"([^"]*)",\s*"([^"]*)"\s*.*\);\s*(return\s+false)?/))){this.src.popup.use.attr("checked","on");this.src.popup.url.val(m[1]);this.src.popup.name.val(m[2]);if(/location=yes/.test(m[3])){this.src.popup.location.attr("checked",true)}if(/menubar=yes/.test(m[3])){this.src.popup.menubar.attr("checked",true)}if(/toolbar=yes/.test(m[3])){this.src.popup.toolbar.attr("checked",true)}if(/scrollbars=yes/.test(m[3])){this.src.popup.scrollbars.attr("checked",true)}if(/status=yes/.test(m[3])){this.src.popup.status.attr("checked",true)}if(/resizable=yes/.test(m[3])){this.src.popup.resizable.attr("checked",true)}if(/dependent=yes/.test(m[3])){this.src.popup.dependent.attr("checked",true)}if((_m=m[3].match(/width=([^,]+)/))){this.src.popup.width.val(_m[1])}if((_m=m[3].match(/height=([^,]+)/))){this.src.popup.height.val(_m[1])}if((_m=m[3].match(/left=([^,]+)/))){this.src.popup.left.val(_m[1])}if((_m=m[3].match(/top=([^,]+)/))){this.src.popup.top.val(_m[1])}if(m[4]){this.src.popup.retfalse.attr("checked",true)}}else{b.each(this.src.popup,function(){var k=b(this);if(k.attr("type")=="text"){k.val(k.attr("name")=="url"?"http://":"")}else{if(k.attr("name")=="retfalse"){this.attr("checked",true)}else{k.removeAttr("checked")}}})}};this.updateOnclick=function(){var p=this.src.popup.url.val();if(this.src.popup.use.attr("checked")&&p){var q="";if(this.src.popup.location.attr("checked")){q+="location=yes,"}if(this.src.popup.menubar.attr("checked")){q+="menubar=yes,"}if(this.src.popup.toolbar.attr("checked")){q+="toolbar=yes,"}if(this.src.popup.scrollbars.attr("checked")){q+="scrollbars=yes,"}if(this.src.popup.status.attr("checked")){q+="status=yes,"}if(this.src.popup.resizable.attr("checked")){q+="resizable=yes,"}if(this.src.popup.dependent.attr("checked")){q+="dependent=yes,"}if(this.src.popup.width.val()){q+="width="+this.src.popup.width.val()+","}if(this.src.popup.height.val()){q+="height="+this.src.popup.height.val()+","}if(this.src.popup.left.val()){q+="left="+this.src.popup.left.val()+","}if(this.src.popup.top.val()){q+="top="+this.src.popup.top.val()+","}if(q.length>0){q=q.substring(0,q.length-1)}var k=this.src.popup.retfalse.attr("checked")?"return false;":"";var o='window.open("'+p+'", "'+b.trim(this.src.popup.name.val())+'", "'+q+'");'+k;this.src.events.onclick.val(o);if(!this.src.main.href.val()){this.src.main.href.val("#")}}else{var j=this.src.events.onclick.val();j=j.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,"");this.src.events.onclick.val(j)}};this.set=function(){this.updateOnclick();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.history.add();var k=this.rte.utils.absoluteURL(this.src.main.href.val());if(!k){this.link.parents().length&&this.rte.doc.execCommand("unlink",false,null)}else{if(!this.link.parents().length){var o="#--el-editor---"+Math.random();var q=this.rte.doc.execCommand("createLink",false,o);this.link=b('a[href="'+o+'"]',this.rte.doc);this.link.each(function(){var r=b(this);if(!b.trim(r.html())&&!b.trim(r.text())){r.replaceWith(r.text())}})}this.src.main.href.val(k);for(var p in this.src){if(p!="popup"){for(var t in this.src[p]){if(t!="anchors"){var j=b.trim(this.src[p][t].val());if(j){this.link.attr(t,j)}else{this.link.removeAttr(t)}}}}}}this.rte.ui.update(true)}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.nbsp=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){this.rte.history.add();this.rte.selection.insertHtml("&nbsp;",true);this.rte.window.focus();this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.outdent=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){var h=this.find();if(h.node){this.rte.history.add();b(h.node).css(h.type,(h.val>40?h.val-40:0)+"px");this.rte.ui.update()}};this.find=function(k){function h(q){var o={type:"",val:0};var p;if((p=c.rte.dom.attr(q,"style"))){o.type=p.indexOf("padding-left")!=-1?"padding-left":(p.indexOf("margin-left")!=-1?"margin-left":"");o.val=o.type?parseInt(b(q).css(o.type))||0:0}return o}var k=this.rte.selection.getNode();var j=h(k);if(j.val){j.node=k}else{b.each(this.rte.dom.parents(k,"*"),function(){j=h(this);if(j.val){j.node=this;return j}})}return j};this.update=function(){var h=this.find();if(h.node){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(g,d){this.constructor.prototype.constructor.call(this,g,d);this.iframe=b(document.createElement("iframe")).addClass("el-rte-paste-input");this.doc=null;var c=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var h={submit:function(o,p){o.stopPropagation();o.preventDefault();c.paste();p.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}};var k=new elDialogForm(h);k.append(this.iframe).open();this.doc=this.iframe.get(0).contentWindow.document;html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';if(this.rte.options.cssfiles.length){b.each(this.rte.options.cssfiles,function(){html+='<link rel="stylesheet" type="text/css" href="'+this+'" />'})}html+="</head><body>  </body></html>";this.doc.open();this.doc.write(html);this.doc.close();if(!this.rte.browser.msie){try{this.doc.designMode="on"}catch(j){}}else{this.doc.body.contentEditable=true}this.iframe.get(0).contentWindow.focus()};this.paste=function(){b(this.doc.body).find("[class]").removeAttr("class");var h=b.trim(b(this.doc.body).html());if(h){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertHtml(this.rte.filter.fromSource(h));this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.pastetext=function(g,d){this.constructor.prototype.constructor.call(this,g,d);this.input=b("<textarea />").addClass("el-rte-paste-input");var c=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var h={submit:function(k,o){k.stopPropagation();k.preventDefault();c.paste();o.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}};var j=new elDialogForm(h);j.append(this.input).open()};this.paste=function(){var h=b.trim(this.input.val());if(h){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertText(h.replace(/\r?\n/g,"<br />"),true);this.rte.ui.update(true)}this.input.val("")};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.save=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.active=true;this.command=function(){this.rte.save()};this.update=function(){}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.stopfloat=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.find=function(){if(this.rte.selection.collapsed()){var g=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(g&&(this.rte.dom.attr(g,"clear")||b(g).css("clear")!="none")){return g}}};this.command=function(){var g;if((g=this.find())){var g=b(g);this.rte.history.add();if(!g.children().length&&!b.trim(g.text()).length){g.remove()}else{g.removeAttr("clear").css("clear","")}}else{this.rte.history.add();this.rte.selection.insertNode(b(this.rte.dom.create("div")).css("clear","both").get(0),true)}this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");if(this.find()){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.table=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.src=null;this.labels=null;function h(){c.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"};c.src={main:{caption:b('<input type="text" />'),rows:b('<input type="text" />').attr("size",5).val(2),cols:b('<input type="text" />').attr("size",5).val(2),width:b('<input type="text" />').attr("size",5),wunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),height:b('<input type="text" />').attr("size",5),hunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),align:b("<select />").append(b("<option />").val("").text(c.rte.i18n("Not set"))).append(b("<option />").val("left").text(c.rte.i18n("Left"))).append(b("<option />").val("center").text(c.rte.i18n("Center"))).append(b("<option />").val("right").text(c.rte.i18n("Right"))),spacing:b('<input type="text" />').attr("size",5),padding:b('<input type="text" />').attr("size",5),border:b("<div />"),rules:b("<select />").append(b("<option />").val("none").text(c.rte.i18n("No"))).append(b("<option />").val("all").text(c.rte.i18n("Cells"))).append(b("<option />").val("groups").text(c.rte.i18n("Groups"))).append(b("<option />").val("rows").text(c.rte.i18n("Rows"))).append(b("<option />").val("cols").text(c.rte.i18n("Columns"))),margin:b("<div />"),bg:b("<div />"),bgimg:b('<input type="text" />').css("width","90%")},adv:{id:b('<input type="text" />'),summary:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").append(b("<option />").text(c.rte.i18n("Not set")).val("")).append(b("<option />").text(c.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(c.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />')},events:{}};b.each(c.src,function(){for(var k in this){this[k].attr("name",k);var j=this[k].get(0).nodeName;if(j=="INPUT"&&k!="bgimg"){this[k].css(this[k].attr("size")?{"text-align":"right"}:{width:"100%"})}else{if(j=="SELECT"&&k!="wunit"&&k!="hunit"){this[k].css("width","100%")}}}});b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){c.src.events[this]=b('<input type="text" />').attr("name",this).css("width","100%")});c.src.main.align.change(function(){var k=b(this).val();if(k=="center"){c.src.main.margin.val({left:"auto",right:"auto"})}else{var j=c.src.main.margin.val();if(j.left=="auto"&&j.right=="auto"){c.src.main.margin.val({left:"",right:""})}}});c.src.main.bgimg.change(function(){var j=b(this);j.val(c.rte.utils.absoluteURL(j.val()))})}this.command=function(){var r=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/);if(this.name=="table"){this.table=b(this.rte.doc.createElement("table"))}else{this.table=r?b(r):b(this.rte.doc.createElement("table"))}!this.src&&h();this.src.main.border.elBorderSelect({styleHeight:117});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.margin.elPaddingInput({type:"margin",value:this.table});if(this.table.parents().length){this.src.main.rows.val("").attr("disabled",true);this.src.main.cols.val("").attr("disabled",true)}else{this.src.main.rows.val(2).removeAttr("disabled");this.src.main.cols.val(2).removeAttr("disabled")}var D=this.table.css("width")||this.table.attr("width");this.src.main.width.val(parseInt(D)||"");this.src.main.wunit.val(D.indexOf("px")!=-1?"px":"%");var z=this.table.css("height")||this.table.attr("height");this.src.main.height.val(parseInt(z)||"");this.src.main.hunit.val(z&&z.indexOf("px")!=-1?"px":"%");var B=this.table.css("float");this.src.main.align.val("");if(B=="left"||B=="right"){this.src.main.align.val(B)}else{var t=this.table.css("margin-left");var p=this.table.css("margin-right");if(t=="auto"&&p=="auto"){this.src.main.align.val("center")}}this.src.main.border.val(this.table);this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules"));this.src.main.bg.val(this.table.css("background-color"));var j=this.table.css("background-image").replace(/url\(([^\)]+)\)/i,"$1");this.src.main.bgimg.val(j!="none"?j:"");var k={submit:function(v,w){v.stopPropagation();v.preventDefault();c.set();w.close()},dialog:{width:530,title:this.rte.i18n("Table")}};var C=new elDialogForm(k);for(var q in this.src){C.tab(q,this.rte.i18n(this.labels[q]));if(q=="main"){var A=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Rows")+"</td>").append(b("<td />").append(this.src.main.rows))).append(b("<tr />").append("<td>"+this.rte.i18n("Columns")+"</td>").append(b("<td />").append(this.src.main.cols)));var x=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Width")+"</td>").append(b("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(b("<tr />").append("<td>"+this.rte.i18n("Height")+"</td>").append(b("<td />").append(this.src.main.height).append(this.src.main.hunit)));var u=b("<table />").append(b("<tr />").append("<td>"+this.rte.i18n("Spacing")+"</td>").append(b("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(b("<tr />").append("<td>"+this.rte.i18n("Padding")+"</td>").append(b("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));C.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",true).separator("main").append([A,x,u],"main",true).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Background"),b("<span />").append(b("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true)}else{for(var o in this.src[q]){var E=this.rte.dom.attr(this.table,o);if(q=="events"){E=this.rte.utils.trimEventCallback(E)}C.append([this.rte.i18n(this.labels[o]?this.labels[o]:o),this.src[q][o].val(E)],q,true)}}}C.open()};this.set=function(){if(!this.table.parents().length){var j=parseInt(this.src.main.rows.val())||0;var z=parseInt(this.src.main.cols.val())||0;if(j<=0||z<=0){return}this.rte.history.add();var B=b(this.rte.doc.createElement("tbody")).appendTo(this.table);var A=b("<tr />");for(var q=0;q<z;q++){A.append(b("<td />").html("&nbsp;"))}for(var q=0;q<j;q++){B.append(A.clone(true))}this.rte.selection.insertNode(this.table.get(0),true)}else{this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style")}var G=b.trim(this.src.main.caption.val());if(G){if(!this.table.children("caption").length){this.table.prepend(b("<caption />"))}this.table.children("caption").text(G)}else{this.table.children("caption").remove()}for(var o in this.src){if(o!="main"){for(var k in this.src[o]){var E=b.trim(this.src[o][k].val());if(E){this.table.attr(k,E)}else{this.table.removeAttr(k)}}}}var x,C,F;if((x=parseInt(this.src.main.spacing.val()))&&x>=0){this.table.attr("cellspacing",x)}if((C=parseInt(this.src.main.padding.val()))&&C>=0){this.table.attr("cellpadding",C)}if((F=this.src.main.rules.val())){this.table.attr("rules",F)}var D=parseInt(this.src.main.width.val())||"",t=parseInt(this.src.main.height.val())||"",q=b.trim(this.src.main.bgimg.val()),B=this.src.main.border.val(),p=this.src.main.margin.val(),u=this.src.main.align.val();this.table.css({width:D?D+this.src.main.wunit.val():"",height:t?t+this.src.main.hunit.val():"",border:b.trim(B.width+" "+B.style+" "+B.color),"background-color":this.src.main.bg.val(),"background-image":q?"url("+q+")":""});if(p.css){this.table.css("margin",p.css)}else{this.table.css({"margin-top":p.top,"margin-right":p.right,"margin-bottom":p.bottom,"margin-left":p.left})}if((u=="left"||u=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"){this.table.css("float",u)}if(!this.table.attr("style")){this.table.removeAttr("style")}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");if(this.name=="tableprops"&&!this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.addClass("disabled").removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tablerm=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){var g=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);if(g){this.rte.history.add();b(g).remove()}this.rte.ui.update(true)};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.src=null;this.labels=null;function h(){c.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"};c.src={main:{type:b("<select />").css("width","100%").append(b("<option />").val("td").text(c.rte.i18n("Data"))).append(b("<option />").val("th").text(c.rte.i18n("Header"))),width:b('<input type="text" />').attr("size",4),wunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),height:b('<input type="text" />').attr("size",4),hunit:b("<select />").append(b("<option />").val("%").text("%")).append(b("<option />").val("px").text("px")),align:b("<select />").css("width","100%").append(b("<option />").val("").text(c.rte.i18n("Not set"))).append(b("<option />").val("left").text(c.rte.i18n("Left"))).append(b("<option />").val("center").text(c.rte.i18n("Center"))).append(b("<option />").val("right").text(c.rte.i18n("Right"))).append(b("<option />").val("justify").text(c.rte.i18n("Justify"))),border:b("<div />"),padding:b("<div />"),bg:b("<div />"),bgimg:b('<input type="text" />').css("width","90%"),apply:b("<select />").css("width","100%").append(b("<option />").val("").text(c.rte.i18n("Current cell"))).append(b("<option />").val("row").text(c.rte.i18n("All cells in row"))).append(b("<option />").val("column").text(c.rte.i18n("All cells in column"))).append(b("<option />").val("table").text(c.rte.i18n("All cells in table")))},adv:{id:b('<input type="text" />'),"class":b('<input type="text" />'),style:b('<input type="text" />'),dir:b("<select />").css("width","100%").append(b("<option />").text(c.rte.i18n("Not set")).val("")).append(b("<option />").text(c.rte.i18n("Left to right")).val("ltr")).append(b("<option />").text(c.rte.i18n("Right to left")).val("rtl")),lang:b('<input type="text" />')},events:{}};b.each(c.src,function(){for(var j in this){this[j].attr("name",j);if(this[j].attr("type")=="text"&&!this[j].attr("size")&&j!="bgimg"){this[j].css("width","100%")}}});b.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){c.src.events[this]=b('<input type="text" />').attr("name",this).css("width","100%")})}this.command=function(){!this.src&&h();this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(!this.cell){return}this.src.main.type.val(this.cell.nodeName.toLowerCase());this.cell=b(this.cell);this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.padding.elPaddingInput({value:this.cell});var j=this.cell.css("width")||this.cell.attr("width");this.src.main.width.val(parseInt(j)||"");this.src.main.wunit.val(j.indexOf("px")!=-1?"px":"%");var q=this.cell.css("height")||this.cell.attr("height");this.src.main.height.val(parseInt(q)||"");this.src.main.hunit.val(q.indexOf("px")!=-1?"px":"%");this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align"));this.src.main.bg.val(this.cell.css("background-color"));var t=this.cell.css("background-image");this.src.main.bgimg.val(t&&t!="none"?t.replace(/url\(([^\)]+)\)/i,"$1"):"");this.src.main.apply.val("");var r={submit:function(v,w){v.stopPropagation();v.preventDefault();c.set();w.close()},dialog:{width:"auto",title:this.rte.i18n("Table cell properties")}};var u=new elDialogForm(r);for(var p in this.src){u.tab(p,this.rte.i18n(this.labels[p]));if(p=="main"){u.append([this.rte.i18n("Width"),b("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",true).append([this.rte.i18n("Height"),b("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",true).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",true).append([this.rte.i18n("Background"),b("<span />").append(b("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",true)}else{for(var o in this.src[p]){var k=this.cell.attr(o)||"";if(p=="events"){k=this.rte.utils.trimEventCallback(k)}u.append([this.rte.i18n(this.labels[o]?this.labels[o]:o),this.src[p][o].val(k)],p,true)}}}u.open()};this.set=function(){b(D).remove();var x=this.cell,B=this.src.main.apply.val();switch(this.src.main.apply.val()){case"row":x=this.cell.parent("tr").children("td,th");break;case"column":x=b(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":x=this.cell.parents("table").find("td,th");break}for(var o in this.src){if(o!="main"){for(var k in this.src[o]){var C=b.trim(this.src[o][k].val());if(C){x.attr(k,C)}else{x.removeAttr(k)}}}}x.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var D=this.src.main.type.val();var A=parseInt(this.src.main.width.val())||"";var r=parseInt(this.src.main.height.val())||"";var q=b.trim(this.src.main.bgimg.val());var z=this.src.main.border.val();var u={width:A?A+this.src.main.wunit.val():"",height:r?r+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":q?"url("+q+")":"",border:b.trim(z.width+" "+z.style+" "+z.color),"text-align":this.src.main.align.val()||""};var j=this.src.main.padding.val();if(j.css){u.padding=j.css}else{u["padding-top"]=j.top;u["padding-right"]=j.right;u["padding-bottom"]=j.bottom;u["padding-left"]=j.left}x=x.get();b.each(x,function(){var E=this.nodeName.toLowerCase();var G=b(this);if(E!=D){var p={};for(var w in c.src.adv){var t=G.attr(w);if(t){p[w]=t.toString()}}for(var w in c.src.events){var t=G.attr(w);if(t){p[w]=t.toString()}}var H=G.attr("colspan")||1;var F=G.attr("rowspan")||1;if(H>1){p.colspan=H}if(F>1){p.rowspan=F}G.replaceWith(b("<"+D+" />").html(G.html()).attr(p).css(u))}else{G.css(u)}});this.rte.ui.update()};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(h,g){this.constructor.prototype.constructor.call(this,h,g);var d=this;function c(){var k=d.rte.dom.selfOrParent(d.rte.selection.getStart(),/^(TD|TH)$/);var j=d.rte.dom.selfOrParent(d.rte.selection.getEnd(),/^(TD|TH)$/);if(k&&j&&k!=j&&b(k).parents("table").get(0)==b(j).parents("table").get(0)){return[k,j]}return null}this.command=function(){var A=c();if(A){var z=this.rte.dom.indexOf(b(A[0]).parent("tr").get(0));var t=this.rte.dom.indexOf(b(A[1]).parent("tr").get(0));var r=Math.min(z,t);var v=Math.max(z,t)-r+1;var k=this.rte.dom.tableColumn(A[0],true,true);var j=this.rte.dom.tableColumn(A[1],true);var C=b.inArray(A[0],k.column);var x=b.inArray(A[1],j.column);var q=k.info.offset[C]<j.info.offset[x]?k:j;var w=k.info.offset[C]>=j.info.offset[x]?k:j;var o=0;var u=null;var p="";this.rte.history.add();var B=b(b(A[0]).parents("table").eq(0).find("tr").get().slice(r,r+v)).each(function(F){var E=p.length;var D=false;b(this).children("td,th").each(function(){var L=b(this);var J=b.inArray(this,q.column);var I=b.inArray(this,w.column);if(J!=-1||I!=-1){D=J!=-1&&I==-1;var H=parseInt(L.attr("colspan")||1);if(F==0){o+=H}if(J!=-1&&F>0){var M=q.info.delta[J];if(M>0){if(L.css("text-align")=="left"){var G=L.clone(true);L.html("&nbsp;")}else{var G=L.clone().html("&nbsp;")}G.removeAttr("colspan").removeAttr("id").insertBefore(this);if(M>1){G.attr("colspan",M)}}}if(I!=-1){var M=w.info.delta[I];if(H-M>1){var K=H-M-1;if(L.css("text-align")=="right"){var G=L.clone(true);L.html("&nbsp;")}else{var G=L.clone().html("&nbsp;")}G.removeAttr("colspan").removeAttr("id").insertAfter(this);if(K>1){G.attr("colspan",K)}}}if(!u){u=L}else{p+=L.html();L.remove()}}else{if(D){if(F==0){o+=parseInt(L.attr("colspan")||1)}p+=L.html();L.remove()}}});p+=E!=p.length?"<br />":""});u.removeAttr("colspan").removeAttr("rowspan").html(u.html()+p);if(o>1){u.attr("colspan",o)}if(v>1){u.attr("rowspan",v)}this.rte.dom.fixTable(b(A[0]).parents("table").get(0))}};this.update=function(){if(c()){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){var k=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(k){this.rte.history.add();var o=parseInt(this.rte.dom.attr(k,"colspan"));var p=parseInt(this.rte.dom.attr(k,"rowspan"));if(o>1||p>1){var v=o-1;var w=p-1;var t=this.rte.dom.parent(k,/^TABLE$/);var q=this.rte.dom.tableMatrix(t);if(v){for(var u=0;u<v;u++){b(this.rte.dom.create(k.nodeName)).html("&nbsp;").insertAfter(k)}}if(w){var z=this.rte.dom.indexesOfCell(k,q);var j=z[0];var h=z[1];for(var g=j+1;g<j+w+1;g++){var x;if(!q[g][h].nodeName){if(q[g][h-1].nodeName){x=q[g][h-1]}else{for(var u=h-1;u>=0;u--){if(q[g][u].nodeName){x=q[g][u];break}}}if(x){for(var u=0;u<=v;u++){b(this.rte.dom.create(x.nodeName)).html("&nbsp;").insertAfter(x)}}}}}b(k).removeAttr("colspan").removeAttr("rowspan");this.rte.dom.fixTable(t)}}this.rte.ui.update(true)};this.update=function(){var g=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(g&&(parseInt(this.rte.dom.attr(g,"colspan"))>1||parseInt(this.rte.dom.attr(g,"rowspan"))>1)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){var h=this.rte.dom.tableColumn(this.rte.selection.getNode(),false,true);if(h.length){this.rte.history.add();b.each(h,function(){var k=b(this);var j=parseInt(k.attr("colspan")||1);if(j>1){k.attr("colspan",j+1)}else{var o=k.clone().html("&nbsp;").removeAttr("colspan").removeAttr("width").removeAttr("id");if(c.name=="tbcolbefore"){o.insertBefore(this)}else{o.insertAfter(this)}}});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){var q=this.rte.selection.getNode();var p=this.rte.dom.selfOrParent(q,/^(TD|TH)$/);var o=b(p).prev("td,th").get(0);var k=b(p).next("td,th").get(0);var h=this.rte.dom.parent(q,/^TABLE$/);var j=this.rte.dom.tableColumn(q,false,true);if(j.length){this.rte.history.add();b.each(j,function(){var t=b(this);var r=parseInt(t.attr("colspan")||1);if(r>1){t.attr("colspan",r-1)}else{t.remove()}});this.rte.dom.fixTable(h);if(o||k){this.rte.selection.selectContents(o?o:k).collapse(true)}this.rte.ui.update(true)}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var h=this.rte.selection.getNode();var t=this.rte.dom.selfOrParent(h,/^(TD|TH)$/);var d=this.rte.dom.selfOrParent(t,/^TR$/);var w=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(t,/^TABLE$/));if(t&&d&&w){this.rte.history.add();var u=this.name=="tbrowbefore";var q=$(d).prevAll("tr").length;var j=0;var p=[];function k(r,z){while(z>0){z--;if(w[z]&&w[z][r]&&w[z][r].nodeName){return w[z][r]}}}for(var o=0;o<w[q].length;o++){if(w[q][o]&&w[q][o].nodeName){var v=$(w[q][o]);var g=parseInt(v.attr("colspan")||1);if(parseInt(v.attr("rowspan")||1)>1){if(u){j+=g}else{p.push(v)}}else{j+=g}}else{if(w[q][o]=="-"){v=k(o,q);v&&p.push($(v))}}}var x=$("<tr />");for(var o=0;o<j;o++){x.append("<td>&nbsp;</td>")}if(u){x.insertBefore(d)}else{x.insertAfter(d)}$.each(p,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore;(function(b){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(g,d){this.constructor.prototype.constructor.call(this,g,d);var c=this;this.command=function(){var j=this.rte.selection.getNode(),z=this.rte.dom.selfOrParent(j,/^(TD|TH)$/),h=this.rte.dom.selfOrParent(z,/^TR$/),t=this.rte.dom.selfOrParent(z,/^TABLE$/),B=this.rte.dom.tableMatrix(t);if(z&&h&&B.length){this.rte.history.add();if(B.length==1){b(t).remove();return this.rte.ui.update()}var v=[];var w=b(h).prevAll("tr").length;function q(r,D){while(D>0){D--;if(B[D]&&B[D][r]&&B[D][r].nodeName){return B[D][r]}}}function C(D,r){y=w+1;var F=null;if(B[y]){for(var E=0;E<r;E++){if(B[y][E]&&B[y][E].nodeName){F=B[y][E]}}D=D.remove();if(F){D.insertAfter(F)}else{D.prependTo(b(h).next("tr").eq(0))}}}function p(D){for(var r=0;r<D.length;r++){if(D[r]==z){return r<D.length-1?D[r+1]:D[r-1]}}}for(var u=0;u<B[w].length;u++){var A=null;var k=false;if(B[w][u]&&B[w][u].nodeName){A=B[w][u];k=true}else{if(B[w][u]=="-"&&(A=q(u,w))){k=false}}if(A){A=b(A);var o=parseInt(A.attr("rowspan")||1);if(o>1){A.attr("rowspan",o-1);k&&C(A,u,w)}}}var x=p(this.rte.dom.tableColumn(z));if(x){this.rte.selection.selectContents(x).collapse(true)}b(h).remove()}this.rte.ui.update()};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.undo=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){if(this.name=="undo"&&this.rte.history.canBack()){this.rte.history.back();this.rte.ui.update()}else{if(this.name=="redo"&&this.rte.history.canFwd()){this.rte.history.fwd();this.rte.ui.update()}}};this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}};elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo})(jQuery);(function(b){elRTE.prototype.ui.prototype.buttons.unlink=function(d,c){this.constructor.prototype.constructor.call(this,d,c);this.command=function(){var o=this.rte.selection.getNode(),g=this.rte.dom.selfOrParentLink(o);function k(p){return p.nodeName=="A"&&p.href}if(!g){var j=b.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(j.length){for(var h=0;h<j.length;h++){if(k(j[h])){g=j[h];break}}if(!g){g=this.rte.dom.parent(j[0],k)||this.rte.dom.parent(j[j.length-1],k)}}}if(g){this.rte.history.add();this.rte.selection.select(g);this.rte.doc.execCommand("unlink",false,null);this.rte.ui.update(true)}};this.update=function(){var g=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(g)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(h){return h.nodeName=="A"&&h.href})){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}}}})(jQuery);